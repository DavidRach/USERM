devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
# merge sig df ####
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
devtools::document()
# library(GateData)
# library(ggplot2)
# library(reshape2)
# library(progress)
# library(shiny)
# library(DT)
# library(dplyr)
# library(rmarkdown)
# library(patchwork)
#
devtools::install_github("xiangmingcai/USERM")
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
Sig_df = SigList2df(SigList= Sig_list,SigName = "id")
Sig_mtx = as.matrix(Sig_df)
colnames(Sig_mtx)
#initial SuprObj
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = readRDS(file = paste0(tmp_dir,"/Estimation_",save_suf,"_ResObj.rds"))
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,2] = c(500,520,530,540)
SuprObj$Intensity_mtx[,3] = c(300,320,330,340)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
PredMultipleSpread(Userm = SuprObj,population_ids = c("V1","V2","V3"))
library(USERM)
data_dir = "E:/ResidualModel/RscriptSUPR/data"
report_tmp_dir = "E:/ResidualModel/RscriptSUPR/report_tmp"
tmp_dir = "E:/ResidualModel/RscriptSUPR/tmp"
Sig_list = readRDS(paste0(tmp_dir,"/Sig_list.rds"))
View(Sig_list)
for (i in 1:length(Sig_list)) {
Sig_list[[i]]$instrument = "Xenith"
}
saveRDS(Sig_list, file = paste0(tmp_dir,"/Sig_list.rds"))
Sig_list = readRDS(paste0("E:/UnmixOpimizer/USERM/inst/sig","/Sig_list.rds"))
View(Sig_list)
length(Sig_list)
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 3))
colnames(SuprObj$Intensity_mtx)
info_df
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 3,dimnames = list(NA,c("id","PrimaryName","SecondaryName","detectors","instrument"))))
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 4,dimnames = list(NA,c("id","PrimaryName","SecondaryName","detectors","instrument"))))
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 4))
colnames(info_df) = c("id","PrimaryName","SecondaryName","detectors","instrument")
_
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 4))
info_df
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 5))
colnames(info_df) = c("id","PrimaryName","SecondaryName","detectors","instrument")
info_df
Sig_list[[1]]$Signature
info_df[i,"detectors"] = dim(Sig_list[[1]]$Signature)
dim(Sig_list[[1]]$Signature)
length(Sig_list[[1]]$Signature)
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 5))
colnames(info_df) = c("id","PrimaryName","SecondaryName","detectors","instrument")
for (i in 1:length(Sig_list)) {
info_df[i,"id"] = Sig_list[[1]]$id
info_df[i,"PrimaryName"] = Sig_list[[1]]$PrimaryName
info_df[i,"SecondaryName"] = Sig_list[[1]]$SecondaryName
info_df[i,"detectors"] = length(Sig_list[[1]]$Signature)
info_df[i,"instrument"] = Sig_list[[1]]$instrument
}
info_df
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 5))
colnames(info_df) = c("id","PrimaryName","SecondaryName","detectors","instrument")
for (i in 1:length(Sig_list)) {
info_df[i,"id"] = Sig_list[[i]]$id
info_df[i,"PrimaryName"] = Sig_list[[i]]$PrimaryName
info_df[i,"SecondaryName"] = Sig_list[[i]]$SecondaryName
info_df[i,"detectors"] = length(Sig_list[[i]]$Signature)
info_df[i,"instrument"] = Sig_list[[i]]$instrument
}
info_df
querySig = function(){
Sig_list = readRDS(paste0("E:/UnmixOpimizer/USERM/inst/sig","/Sig_list.rds"))
info_df = as.data.frame(matrix(nrow = length(Sig_list), ncol = 5))
colnames(info_df) = c("id","PrimaryName","SecondaryName","detectors","instrument")
for (i in 1:length(Sig_list)) {
info_df[i,"id"] = Sig_list[[i]]$id
info_df[i,"PrimaryName"] = Sig_list[[i]]$PrimaryName
info_df[i,"SecondaryName"] = Sig_list[[i]]$SecondaryName
info_df[i,"detectors"] = length(Sig_list[[i]]$Signature)
info_df[i,"instrument"] = Sig_list[[i]]$instrument
}
return(info_df)
}
#querySig
Sig_info = querySig()
Sig_info
#getSigMtx
getSigMtx(ids = c())
colnames(SuprObj$Intensity_mtx)
c(Sig_info$id[1:3])
ids = c(Sig_info$id[1:3])
Sig_list_sub = Sig_list[[1,2,3]]
Sig_list_sub = Sig_list[[c(1,2,3)]]
Sig_list_sub = Sig_list[c(1,2,3)]
Sig_list_sub
View(Sig_list_sub)
ids_inlist = c()
for (i in 1:length(Sig_list)) {
ids_inlist = c(ids_inlist,Sig_list[[i]]$id)
}
ids_inlist
indices = c()
for (j in 1:length(ids)) {
tmp_loc = NA
for (i in 1:length(Sig_list)) {
print(i)
if(Sig_list[[i]]$id == ids[j]){
tmp_loc = i
break
}
}
}
indices = c()
for (j in 1:length(ids)) {
tmp_loc = NA
for (i in 1:length(Sig_list)) {
print(i)
if(Sig_list[[i]]$id == ids[j]){
tmp_loc = i
break
}
}
if (! is.na(tmp_loc)){
indices = c(indices,tmp_loc)
} else {
stop(paste0("The id: ",ids[j]," is not found in the Signature database."))
}
}
indices
# check detectors
first_detectors = names(Sig_list[[1]]$Signature)
first_detectors
T && F
F && F
F && T
T && T
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(length(Sig_list)))
mtx
length(Sig_list)
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
mtx
rownames(mtx) = first_detectors
mtx
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
for (i in 1:ncol(mtx)) {
mtx[,i] = Sig_list[[i]]$Signature
}
mtx
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
for (i in 1:ncol(mtx)) {
mtx[(names(Sig_list[[i]]$Signature)),i] = Sig_list[[i]]$Signature
}
mtx
colnames(mtx)
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
for (i in 1:ncol(mtx)) {
mtx[(names(Sig_list[[i]]$Signature)),i] = Sig_list[[i]]$Signature
colnames(mtx)[i] = Sig_list[[i]]$id
}
Sig_list[[i]]$id
colnames(mtx)[i]
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
cols = c()
for (i in 1:ncol(mtx)) {
mtx[(names(Sig_list[[i]]$Signature)),i] = Sig_list[[i]]$Signature
cols = c(cols, Sig_list[[i]]$id)
}
cols
colnames(mtx) = cols
mtx
getSigMtx = function(ids){
Sig_list = readRDS(paste0("E:/UnmixOpimizer/USERM/inst/sig","/Sig_list.rds"))
# find ids location
indices = c()
for (j in 1:length(ids)) {
tmp_loc = NA
for (i in 1:length(Sig_list)) {
# print(i)
if(Sig_list[[i]]$id == ids[j]){
tmp_loc = i
break
}
}
if (! is.na(tmp_loc)){
indices = c(indices,tmp_loc)
} else {
stop(paste0("The id: ",ids[j]," is not found in the Signature database."))
}
}
Sig_list = Sig_list[indices]
# check detectors
first_detectors = names(Sig_list[[1]]$Signature)
for (i in 1:length(Sig_list)) {
tmp_detectors = names(Sig_list[[i]]$Signature)
if(!all((tmp_detectors %in% first_detectors) && (length(first_detectors) == length(tmp_detectors)))){
warning("Selected signatures have distinct detectors. Signature list is returned instead. Please check detectors and run again.")
return(Sig_list)
}
}
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
cols = c()
for (i in 1:ncol(mtx)) {
mtx[(names(Sig_list[[i]]$Signature)),i] = Sig_list[[i]]$Signature
cols = c(cols, Sig_list[[i]]$id)
}
colnames(mtx) = cols
return(mtx)
}
#getSigMtx
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[1:3]))
getSigMtx = function(ids){
Sig_list = readRDS(paste0("E:/UnmixOpimizer/USERM/inst/sig","/Sig_list.rds"))
# find ids location
indices = c()
for (j in 1:length(ids)) {
tmp_loc = NA
for (i in 1:length(Sig_list)) {
# print(i)
if(Sig_list[[i]]$id == ids[j]){
tmp_loc = i
break
}
}
if (! is.na(tmp_loc)){
indices = c(indices,tmp_loc)
} else {
stop(paste0("The id: ",ids[j]," is not found in the Signature database."))
}
}
Sig_list = Sig_list[indices]
# check detectors
first_detectors = names(Sig_list[[1]]$Signature)
for (i in 1:length(Sig_list)) {
tmp_detectors = names(Sig_list[[i]]$Signature)
if(!(all((tmp_detectors %in% first_detectors)) && (length(first_detectors) == length(tmp_detectors)))){
warning("Selected signatures have distinct detectors. Signature list is returned instead. Please check detectors and run again.")
return(Sig_list)
}
}
#prepare matrix
mtx = matrix(nrow = length(first_detectors), ncol = length(Sig_list))
rownames(mtx) = first_detectors
cols = c()
for (i in 1:ncol(mtx)) {
mtx[(names(Sig_list[[i]]$Signature)),i] = Sig_list[[i]]$Signature
cols = c(cols, Sig_list[[i]]$id)
}
colnames(mtx) = cols
return(mtx)
}
#getSigMtx
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[1:3]))
Sig_mtx
SuprObj = CreateUserm(A = Sig_mtx)
View(SuprObj)
#getRes
id = Sig_info$id[1]
id
Res = readRDS(paste0("E:/UnmixOpimizer/USERM/inst/res/ResObj_",id,".rds"))
View(Res)
file_addr = paste0("E:/UnmixOpimizer/USERM/inst/res/ResObj_",id,".rds")
file.exists(file_addr)
getRes = function(id){
file_addr = paste0("E:/UnmixOpimizer/USERM/inst/res/ResObj_",id,".rds")
if(file.exists(file_addr)){
Res = readRDS(file_addr)
return(Res)
}else{
stop("The Res object for the id is not found. Please check the id and try again.")
}
}
getRes = function(id){
file_addr = paste0("E:/UnmixOpimizer/USERM/inst/res/ResObj_",id,".rds")
if(file.exists(file_addr)){
Res = readRDS(file_addr)
return(Res)
}else{
stop("The Res object for the id is not found. Please check the id and try again.")
}
}
Res = getRes(id = Sig_info$id[1])
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
View(SuprObj)
PredOneSpread(Userm = SuprObj,population_id = c("V2"))
PredOneSpread(Userm = SuprObj,population_id = c("V1"))
ids
devtools::document()
