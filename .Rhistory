# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-50, 100), ylim = c(-50, 100)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 100,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-50, 100), ylim = c(-50, 100)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-50, 200), ylim = c(-50, 100)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 200,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-50, 500), ylim = c(-50, 100)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 200,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-50, 500), ylim = c(-50, 500)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 200,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 500), ylim = c(-200, 500)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 300,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 500), ylim = c(-200, 500)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 300,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 50), y = rnorm(1000,mean = 400,sd = 50))
df = rbind(df,df_pn)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 500), ylim = c(-200, 500)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 300,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 50), y = rnorm(1000,mean = 400,sd = 50))
df = rbind(df,df_np)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 500), ylim = c(-200, 500)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 300,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 50), y = rnorm(1000,mean = 400,sd = 50))
df = rbind(df,df_np)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 600), ylim = c(-200, 600)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 50), y = rnorm(1000,mean = 500,sd = 50))
df = rbind(df,df_np)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 0,sd = 50))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 50), y = rnorm(1000,mean = 500,sd = 50))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 500,sd = 50))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 0,sd = 60))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 70), y = rnorm(1000,mean = 500,sd = 80))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 500,sd = 80))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+60), y = rnorm(1000,mean = 0,sd = 20+60))
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+40), y = rnorm(1000,mean = 500,sd = 20+40))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 50), y = rnorm(1000,mean = 500,sd = 80))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+30+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+30+35), y = rnorm(1000,mean = 500,sd = 20+20+35))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+30+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+30+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "正态分布散点图", x = "X", y = "Y") +
theme_minimal()
# 创建数据框
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkred") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "darkblue") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration")
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "lightblue") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration")
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration")
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration",width = 10,height = 10)
print(p)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration",width = 10,height = 10)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration.pdf",width = 10,height = 10)
print(p)
dev.off()
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_minimal()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration.pdf",width = 6,height = 6)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
df_np <- data.frame(x = rnorm(1000,mean = 0,sd = 10+0+20), y = rnorm(1000,mean = 500,sd = 20+20+30))
df = rbind(df,df_np)
df_pp <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+40), y = rnorm(1000,mean = 500,sd = 20+20+40))
df = rbind(df,df_pp)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 800)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration.pdf",width = 6,height = 6)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 200)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
#generate illustration plot
library(ggplot2)
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 200)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration_scc.pdf",width = 6,height = 6)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 200)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration_scc.pdf",width = 6,height = 4)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 200)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration_scc.pdf",width = 6,height = 4)
print(p)
dev.off()
# 创建数据框
set.seed(123)
df <- data.frame(x = rnorm(1000,mean = 0,sd = 10), y = rnorm(1000,mean = 0,sd = 20)) #nn
df_pn <- data.frame(x = rnorm(1000,mean = 400,sd = 10+10+30), y = rnorm(1000,mean = 0,sd = 20+0+20))#neg + int_dis + residual
df = rbind(df,df_pn)
# 绘图
p = ggplot(df, aes(x = x, y = y)) +
geom_point(color = "gray") +
coord_cartesian(xlim = c(-200, 800), ylim = c(-200, 200)) +
labs(title = "simulated data for illustration", x = "CD3", y = "CD4") +
theme_classic()
pdf(file = "E:/ResidualModel/simulated_data_for_illustration_scc.pdf",width = 6,height = 4)
print(p)
dev.off()
library(USERM)
#querySig
Sig_info = querySig()
View(Sig_info)
# Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]))
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj[["Scale_df"]][["min"]] = -100
SuprObj[["Scale_df"]][["max"]] = 1000
SuprObj[["Scale_df"]][["scale"]] = "Linear"
SuprObj[["Scale_df"]][["cofactor"]] = 10
SuprObj$Intensity_mtx[,1] = 100*c(1:length(SuprObj$fluors))
SuprObj$Intensity_mtx[,2] = 200*c(1:length(SuprObj$fluors))
SuprObj$Intensity_mtx[,3] = 300*c(1:length(SuprObj$fluors))
PredOneSpread(Userm = SuprObj,population_id = c("V1"))
PredMultipleSpread(Userm = SuprObj,population_ids = c("V1","V2","V3"))
Spr1 = EstimateSpread(Userm = SuprObj,population_id = c("V1"))
Spr2 = EstimateSpread(Userm = SuprObj,population_id = c("V2"))
SpreadDistance_mtx = EstimateDistance(Spr1, Spr2)
View(Spr1)
View(SpreadDistance_mtx)
Vis_Mtx <- function(mat = NULL, min = -1, mid = 0, max = 1, mincolor = "blue", midcolor = "white", maxcolor = "red") {
if (is.null(mat) || !is.matrix(mat)) {
stop("mat is missing or not a matrix.")
}
col_fun = colorRamp2(c(min, mid, max), c(mincolor, midcolor, maxcolor))
p = Heatmap(mat,col = col_fun, cluster_rows = FALSE,cluster_columns = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(sprintf("%.1f", mat[i, j]), x, y, gp = gpar(fontsize = 6))
},column_title = paste0("slopMtx of ", Res$id),name = "beta")
return(p)
}
Vis_Mtx(mat)
Vis_Mtx(mat = SpreadDistance_mtx)
devtools::document()
