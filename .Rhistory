Sig_info = querySig()
# Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]))
colnames(Sig_mtx)
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj[["Scale_df"]][["min"]] = -100
SuprObj[["Scale_df"]][["max"]] = 20000
SuprObj[["Scale_df"]][["scale"]] = "Linear"
SuprObj[["Scale_df"]][["cofactor"]] = 10
#
#
# SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[1],min = -100, max = 1000, scale = "Linear", cofactor = 10)# c("Linear","Log10","Arcsinh")
# SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[2],min = -100, max = 1000, scale = "Log10", cofactor = 10)# c("Linear","Log10","Arcsinh")
# SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[3],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
# SuprObj = AddScale(Userm = SuprObj,fluor = colnames(Sig_mtx)[4],min = -100, max = 1000, scale = "Arcsinh", cofactor = 10)# c("Linear","Log10","Arcsinh")
SuprObj$Intensity_mtx[,1] = 0*c(1:length(SuprObj$fluors))
SuprObj$Intensity_mtx[23,1] = 10000
Coef_mtx = EstimateCoefMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/CoefMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#ff7500",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
dev.off()
# library(MASS)
Hotspot_mtx = EstimateHotspotMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#ff7500",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
dev.off()
View(SuprObj)
devtools::document()
devtools::install_github("xiangmingcai/USERM")
library(USERM)
library(USERM)
#querySig
Sig_info = querySig()
# Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]))
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj[["Scale_df"]][["min"]] = -100
SuprObj[["Scale_df"]][["max"]] = 20000
SuprObj[["Scale_df"]][["scale"]] = "Linear"
SuprObj[["Scale_df"]][["cofactor"]] = 10
Hotspot_mtx = EstimateHotspotMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#ff7500",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
dev.off()
Coef_mtx = EstimateCoefMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/CoefMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
dev.off()
# library(MASS)
library(lsa)
library(coop)
install.packages(lsa)
install.packages("lsa")
library(lsa)
devtools::document()
devtools::install_github("xiangmingcai/USERM")
library(USERM)
#querySig
Sig_info = querySig()
# Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]))
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
Similarity_mtx = EstimateSimilarityMtx(Userm = SuprObj)
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Cosine",
title = "Cosine similaritymatrix")
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 1,mid = 0.9,min = 0,legend_name = "Cosine",
title = "Cosine similaritymatrix")
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similaritymatrix")
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#cb34db",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#34db56",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#98db34",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
dev.off()
Similarity_mtx = EstimateSimilarityMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/SimilarityMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#98db34",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
dev.off()
Coef_mtx = EstimateCoefMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/CoefMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
dev.off()
Similarity_mtx = EstimateSimilarityMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/SimilarityMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
dev.off()
# library(MASS)
Hotspot_mtx = EstimateHotspotMtx(Userm = SuprObj)
pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
dev.off()
Cohort = read.csv("E:/HC_match/Cohort.csv")
View(Cohort)
HC = read.csv("E:/HC_match/HC.csv")
View(HC)
rownames(HC) = HC$Sample_ID
rownames(HC)[rownames(HC) != "HC0077"]
sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F)
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
HC_select
HC[HC_select,"Age"]
#check
table(Cohort$PA_diagnosis)
Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"]
t.test(x = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Astrocytoma"),"Age"])
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
t_result
t_result$p.value
loop_count = 0
matched = F
while((loop_count<10) & (!matched)){
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
loop_count = 0
matched = F
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
t_result
HC[HC_select,"Age"]
Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"]
HC_select
Cohort = read.csv("E:/HC_match/Cohort.csv")
HC = read.csv("E:/HC_match/HC.csv")
rownames(HC) = HC$Sample_ID
loop_count = 0
matched = F
set.seed(123)
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
t_result
Cohort = read.csv("E:/HC_match/Cohort.csv")
HC = read.csv("E:/HC_match/HC.csv")
rownames(HC) = HC$Sample_ID
loop_count = 0
matched = F
set.seed(123)
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
Cohort = read.csv("E:/HC_match/Cohort.csv")
HC = read.csv("E:/HC_match/HC.csv")
rownames(HC) = HC$Sample_ID
loop_count = 0
matched = F
set.seed(123)
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
Cohort = read.csv("E:/HC_match/Cohort.csv")
HC = read.csv("E:/HC_match/HC.csv")
rownames(HC) = HC$Sample_ID
loop_count = 0
matched = F
set.seed(123)
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
Cohort = read.csv("E:/HC_match/Cohort.csv")
HC = read.csv("E:/HC_match/HC.csv")
rownames(HC) = HC$Sample_ID
loop_count = 0
matched = F
set.seed(123)
while((loop_count<10) & (!matched)){
print(loop_count)
#sample
HC_select = c("HC0077")
HC_select = c(HC_select, sample(rownames(HC)[rownames(HC) != "HC0077"],7,replace = F))
#check
t_result = t.test(x = HC[HC_select,"Age"],
y = Cohort[(Cohort$PA_diagnosis == "Glioblastoma"),"Age"])
if(t_result$p.value>0.05){
matched = T
}
loop_count = loop_count+1
}
HC_select
# devtools::install_github("xiangmingcai/USERM")
library(USERM)
#querySig
Sig_info = querySig()
View(Sig_info)
checkSig_linePlot(id = Sig_info$id[193])
fluor_to_check = Sig_info$id[3]
fluor_to_check
checkSig_linePlot(id = fluor_to_check)
print(fluor_to_check)
#get Residual Obj
ResObj = getRes(id = fluor_to_check)
View(ResObj)
ResObj = getRes(id = fluor_to_check)
checkRes_slopMtx(Res = ResObj)
checkRes_interceptMtx(Res = ResObj)
ResObj$bin_mids
checkRes_covMtx(Res = ResObj,bin=3)
ResObj$detectors
checkRes_covScatter(Res = ResObj,
detector1 = ResObj$detectors[1],
detector2 = ResObj$detectors[2])
Sig_mtx  = getSigMtx(ids = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)]))
fluors_selected = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)])
print(fluors_selected)
Sig_mtx  = getSigMtx(ids = fluors_selected)
View(Sig_mtx)
dim(fluors_selected)
dim(Sig_mtx)
SuprObj = CreateUserm(A = Sig_mtx)
View(SuprObj)
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
SuprObj
#
PredOneSpread(Userm = SuprObj,population_id = c("V1"))
SuprObj$Intensity_mtx[,2] = 200*c(1:length(SuprObj$fluors))
SuprObj$Intensity_mtx[,3] = 300*c(1:length(SuprObj$fluors))
names(SuprObj$Intensity_mtx)
names(SuprObj$Intensity_mtx) = c("P1","P2","P3")
PredMultipleSpread(Userm = SuprObj,population_ids = c("P1","P2","P3"))
# Step 4 matrics estimation and visualization
Coef_mtx = EstimateCoefMtx(Userm = SuprObj)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
dev.off()
Hotspot_mtx = EstimateHotspotMtx(Userm = SuprObj)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
dev.off()
devtools::document()
devtools::document()
devtools::install_github("xiangmingcai/USERM")
# devtools::install_github("xiangmingcai/USERM")
library(USERM)
# Step 1 querySig
Sig_info = querySig()
fluor_to_check = Sig_info$id[3]
print(fluor_to_check)
checkSig_linePlot(id = fluor_to_check)
ResObj = getRes(id = fluor_to_check)
checkRes_slopMtx(Res = ResObj)
checkRes_interceptMtx(Res = ResObj)
ResObj$bin_mids
checkRes_covMtx(Res = ResObj,bin=3)
ResObj$detectors
checkRes_covScatter(Res = ResObj,
detector1 = ResObj$detectors[1],
detector2 = ResObj$detectors[2])
# Step 2 Select fluors and create SuprObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,58:62,8,9,12,14,18,24,25,26,63)])
print(fluors_selected)
Sig_mtx  = getSigMtx(ids = fluors_selected)
dim(Sig_mtx)
SuprObj = CreateUserm(A = Sig_mtx)
#add ResObj into SuprObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
SuprObj = AddRes2Userm(Res = ResObj, Userm = SuprObj)
}
# Step 3 Make prediction (optional)
PredOneSpread(Userm = SuprObj,population_id = c("V1"))
SuprObj$Intensity_mtx[,2] = 200*c(1:length(SuprObj$fluors))
SuprObj$Intensity_mtx[,3] = 300*c(1:length(SuprObj$fluors))
names(SuprObj$Intensity_mtx) = c("P1","P2","P3")
PredMultipleSpread(Userm = SuprObj,population_ids = c("P1","P2","P3"))
# Step 4 matrics estimation and visualization
Coef_mtx = EstimateCoefMtx(Userm = SuprObj)
# pdf(file = "E:/ResidualModel/CoefMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
Hotspot_mtx = EstimateHotspotMtx(A = SuprObj$A)
# pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
Similarity_mtx = EstimateSimilarityMtx(A = SuprObj$A)
# pdf(file = "E:/ResidualModel/SimilarityMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
Spr1 = EstimateSpread(Userm = SuprObj,population_id = c("P1"))
Spr2 = EstimateSpread(Userm = SuprObj,population_id = c("P2"))
SpreadDistance_mtx = EstimateDistance(Spr1, Spr2)
Vis_Mtx(mat = SpreadDistance_mtx,mincolor = "darkred",midcolor = "white", maxcolor = "white",max = 1.5,mid = 1,min = 0,title = "Residual based spread (RBS) matrix")
Vis_Mtx(mat = SpreadDistance_mtx,mincolor = "darkred",midcolor = "white", maxcolor = "white",max = 1.5,mid = 1,min = 0,title = "Spread Distance matrix")
# devtools::install_github("xiangmingcai/USERM")
library(USERM)
# Step 1 querySig
Sig_info = querySig()
head(Sig_info)
fluor_to_check = Sig_info$id[3]
print(fluor_to_check)
checkSig_linePlot(id = fluor_to_check)
ResObj = getRes(id = fluor_to_check)
View(ResObj)
# devtools::install_github("xiangmingcai/USERM")
library(USERM)
# Step 1 querySig
Sig_info = querySig()
head(Sig_info)
fluor_to_check = Sig_info$id[3]
print(fluor_to_check)
checkSig_linePlot(id = fluor_to_check)
ResObj = getRes(id = fluor_to_check)
checkRes_slopMtx(Res = ResObj)
checkRes_interceptMtx(Res = ResObj)
ResObj$bin_mids
checkRes_slopMtx(Res = ResObj)
checkRes_interceptMtx(Res = ResObj)
checkRes_covMtx(Res = ResObj,bin=3)
checkRes_covScatter(Res = ResObj,
detector1 = ResObj$detectors[1],
detector2 = ResObj$detectors[2])
print(ResObj$bin_mids)
# Step 2 Select fluors and create SuprObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54)])#,58:62,8,9,12,14,18,24,25,26,63
print(fluors_selected)
# Step 2 Select fluors and create SuprObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,63)])#,58:62,8,9,12,14,18,24,25,26,63
print(fluors_selected)
# Step 2 Select fluors and create SuprObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,44,46:48,50:54,8,9,12,63)])#,58:62,8,9,12,14,18,24,25,26,63
print(fluors_selected)
# Step 2 Select fluors and create SuprObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,46:48,50:54,8,9,12,63)])#,58:62,8,9,12,14,18,24,25,26,63
print(fluors_selected)
Sig_mtx  = getSigMtx(ids = fluors_selected)
dim(Sig_mtx)
UsermObj = CreateUserm(A = Sig_mtx)
#add ResObj into UsermObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj)
}
View(UsermObj)
# Step 3 Make prediction (optional)
PredOneSpread(Userm = UsermObj,population_id = c("V1"))
# Step 3 Make prediction (optional)
PredOneSpread(Userm = UsermObj,population_id = c("V1"))
UsermObj$Intensity_mtx[,2] = 200*c(1:length(UsermObj$fluors))
UsermObj$Intensity_mtx[,3] = 300*c(1:length(UsermObj$fluors))
names(UsermObj$Intensity_mtx) = c("P1","P2","P3")
PredMultipleSpread(Userm = UsermObj,population_ids = c("P1","P2","P3"))
# devtools::install_github("xiangmingcai/USERM")
library(USERM)
# Step 1 querySig
Sig_info = querySig()
head(Sig_info)
fluor_to_check = Sig_info$id[3]
print(fluor_to_check)
checkSig_linePlot(id = fluor_to_check)
ResObj = getRes(id = fluor_to_check)
checkRes_slopMtx(Res = ResObj)
checkRes_interceptMtx(Res = ResObj)
print(ResObj$bin_mids)
checkRes_covMtx(Res = ResObj,bin=3)
ResObj$detectors
checkRes_covScatter(Res = ResObj,
detector1 = ResObj$detectors[1],
detector2 = ResObj$detectors[2])
# Step 2 Select fluors and create UsermObj
fluors_selected = c(Sig_info$id[c(32:38,41:42,46:48,50:54,8,9,12,63)])#,58:62,8,9,12,14,18,24,25,26,63
print(fluors_selected)
Sig_mtx  = getSigMtx(ids = fluors_selected)
dim(Sig_mtx)
UsermObj = CreateUserm(A = Sig_mtx)
#add ResObj into UsermObj
for (save_suf in colnames(Sig_mtx)) {
ResObj = getRes(id = save_suf)
UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj)
}
# Step 3 Make prediction (optional)
PredOneSpread(Userm = UsermObj,population_id = c("V1"))
UsermObj$Intensity_mtx[,2] = 200*c(1:length(UsermObj$fluors))
UsermObj$Intensity_mtx[,3] = 300*c(1:length(UsermObj$fluors))
names(UsermObj$Intensity_mtx) = c("P1","P2","P3")
# Step 4 matrics estimation and visualization
Coef_mtx = EstimateCoefMtx(Userm = UsermObj)
# pdf(file = "E:/ResidualModel/CoefMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Coef_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Coef",
title = "Coefficient of residual model matrix (Coef Matrix) (row spread into column)")
Hotspot_mtx = EstimateHotspotMtx(A = UsermObj$A)
# pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Hotspot_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 2,mid = 1,min = 0,legend_name = "Hotspot",
title = "Hotspot matrix")
Similarity_mtx = EstimateSimilarityMtx(A = UsermObj$A)
# pdf(file = "E:/ResidualModel/SimilarityMtx.pdf",width = 10,height = 10)
Vis_Mtx(mat = Similarity_mtx,mincolor = "white",midcolor = "white", maxcolor = "#95ABDB",
max = 1,mid = 0.8,min = 0,legend_name = "Cosine",
title = "Cosine similarity matrix")
Spr1 = EstimateSpread(Userm = UsermObj,population_id = c("P1"))
Spr2 = EstimateSpread(Userm = UsermObj,population_id = c("P2"))
SpreadDistance_mtx = EstimateDistance(Spr1, Spr2)
Vis_Mtx(mat = SpreadDistance_mtx,mincolor = "darkred",midcolor = "white", maxcolor = "white",max = 1.5,mid = 1,min = 0,title = "Spread Distance matrix")
# Step 3 Make prediction (optional)
PredOneSpread(Userm = UsermObj,population_id = c("V1"))
# Step 3 Make prediction (optional)
PredOneSpread(Userm = UsermObj,population_id = c("P1"))
citation(USERM)
citation("USERM")
devtools::document()
