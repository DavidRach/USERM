[{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"basic-instruction-for-userm-use","dir":"Articles","previous_headings":"","what":"Basic instruction for USERM use","title":"Basic Instruction","text":"Xiangming Cai 2025-11-22","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"introduction","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"üîç Introduction","title":"Basic Instruction","text":"USERM provides --box tool apply residual model approach 1, characterizes predicts spread unmixed spectral flow cytometry data, arises instrumental noise deviations actual cellular emission average fluorescence signatures. USERM also supports computing various matrixes tools panel design, including Coef Matrix, Hotspot Matrix, Similarity Matrix, many others.","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"installation","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"üíª Installation","title":"Basic Instruction","text":"can install development version USERM GitHub :","code":"devtools::install_github(\"xiangmingcai/USERM\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"step-1-query-avalilable-fluorescence-list","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"Step 1 üìà query avalilable fluorescence list","title":"Basic Instruction","text":"can use querySig function query available fluorescence. check signature specific fluroescence, may   available fluorescence preprocessed parameters extracted residual model. access corresponding residaul model parameters, can use getRes function.   ResObj Object contains relavant informations. interested, please read paper (mentioned top) know concepts matrix shown . See detailed introduction structure ResObj. can easily visaulize matrixes, interested one . check slop matrix:   check intercept matrix:   can check covariance matrix specified fluorescence intensity (bin):   can even check linear fitting covariance versus fluorescence intensity (bin) two speific detectors:","code":"library(USERM) Sig_info = querySig() head(Sig_info) > head(Sig_info)                     id PrimaryName SecondaryName detectors instrument       Source Note 1  SCC_Bead_CD4_NFR700         CD4        NFR700        51     Xenith XiangmingCai   NA 2   SCC_Bead_CD3_BV510         CD3         BV510        51     Xenith XiangmingCai   NA 3    SCC_Bead_CD2_FITC         CD2          FITC        51     Xenith XiangmingCai   NA 4       SCC_Bead_AF_AF          AF            AF        51     Xenith XiangmingCai   NA 5   SCC_Bead_CD8_BV570         CD8         BV570        51     Xenith XiangmingCai   NA 6 SCC_Bead_CD16_BUV805        CD16        BUV805        51     Xenith XiangmingCai   NA fluor_to_check = Sig_info$id[3] print(fluor_to_check) checkSig_linePlot(id = fluor_to_check) > print(fluor_to_check) [1] \"SCC_Bead_CD2_FITC\" ResObj = getRes(id = fluor_to_check) checkRes_slopMtx(Res = ResObj) checkRes_interceptMtx(Res = ResObj) print(ResObj$bin_mids) checkRes_covMtx(Res = ResObj,bin=3) print(ResObj$detectors) checkRes_covScatter(Res = ResObj,                     detector1 = ResObj$detectors[1],                     detector2 = ResObj$detectors[2])"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"step-2-select-and-rename-fluors-and-create-suprobj","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"Step 2 üñä Select and rename fluors and create SuprObj","title":"Basic Instruction","text":"may now select fluorescence make panel. note, targets (e.g.¬†CD3, CD4) matter , fluorescence matches. means plan use FITC-CD4 panel, can use FITC-CD2 USERM make estimation prediction. fluorescence need available USERM, can prepare single color control FCS file process following custom instruction. Assume fluorescence need available, now can select : select 3 fluorescence plus autofluorescence (AF) make simple panel. expecting (>40), just select . Notely, SCC Cells Beads using together. Based research, ok use SCC beads prediction. Now, can create signature matrix selected fluorescence , create UsermObj contain ResObj.   UsermObj contains information needed prediction. Res item list ResObj fluorescence. Scale_df item contains scale setting visualization afterward. ok leave NA. Default linear scale applied (Options: ‚ÄúLinear‚Äù, ‚ÄúLog10‚Äù, ‚ÄúArcsinh‚Äù). Intensity_mtx contains estimated fluorescence intensities cell populations. example shown , one default populaiton named ‚ÄúP1‚Äù. can modify name intensities add new populations interactive prediction Step 3. hope rename fluorescence, can now:","code":"fluors_selected = c(Sig_info$id[c(32:34,63)]) fluors_selected > fluors_selected [1] \"SCC_Cell_LD_LDNIR876\" \"SCC_Cell_CD2_FITC\"    \"SCC_Cell_CD3_BV510\"   \"SCC_Cell_AF_AF\" Sig_mtx  = getSigMtx(ids = fluors_selected) #(detectors x fluorescence) dim(Sig_mtx) > dim(Sig_mtx) [1] 51 4 UsermObj = CreateUserm(A = Sig_mtx) #add ResObj into UsermObj for (save_suf in colnames(Sig_mtx)) {   ResObj = getRes(id = save_suf)   UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj) } UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_LD_LDNIR876\",new_name = \"LiveDead\") UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_CD2_FITC\",new_name = \"CD2_FITC\") UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_CD3_BV510\",new_name = \"CD3_BV510\") UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_AF_AF\",new_name = \"AF\") > UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_LD_LDNIR876\",new_name = \"LiveDead\") Successfully renamed SCC_Cell_LD_LDNIR876 as LiveDead > UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_CD2_FITC\",new_name = \"CD2_FITC\") Successfully renamed SCC_Cell_CD2_FITC as CD2_FITC > UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_CD3_BV510\",new_name = \"CD3_BV510\") Successfully renamed SCC_Cell_CD3_BV510 as CD3_BV510 > UsermObj = RenameFluor(Userm = UsermObj,raw_name = \"SCC_Cell_AF_AF\",new_name = \"AF\") Successfully renamed SCC_Cell_AF_AF as AF"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"step-3-make-prediction-optional","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"Step 3 üßÆ Make prediction (optional)","title":"Basic Instruction","text":"can now interactively predict spread residual model, accounts instrumental noise deviations actual cellular emission average fluorescence signatures. predict one population:   see pop-shinyapp window.   left panel allows users interactively select un-select fluroescence detectors, modify intensities. users can flexibly explore impact fluorescence combination intensities predicted spread. note, can use set-button adjust intensities together. can handy want set 0 except one fluorescence, case simulating SCC sample.   right panel tabs. signature matrix contains normalized signatures. want adjust color threshold, may scroll bottom set new color threshold. tow ways use different color palette. First, can get matrix mathods described Step1 Step4, visualize Vis_Mtx function, also described Step4. Another method can directly copy paste whole matrix Excel apply distinct color palette Excel software.   prediction tab, see scatter plot visualizing 95% range predicted spread. Two display mode supported: Pseudo-color Counter-line. allows selection fluorescence x y axes. can also adjsut display limis axes. Scale support Linear, Log10 Arcsinh options. Arcsinh, users need set cofactor.   note, can now set Factor default Autofluorescence control displayed spread AF. displayed spread multiplied (factor / 100). , factor set 100, estimated spread AF displayed completely. factor set 0, spread AF removed. helps check spread noise.   pinv matrix shows pseudo-inverse signature matrix.   intercept matrix tab, can check intercept matrix SCC.   summary intercept matrix SCC calculated  median value summary intercept matrixes used prediction (last two rows).   slop matrix tab, can check slop matrix fluroescence.   Similarly, summary slop matrix fluorescence calculated  summed value weighted slop matrixes used prediction (last two rows).   check detail number summary slop matrix, can use weighted tab. Select fluorescence channels spread , can check weighted slop matrix. sum weighted slop matrix corresponding value summary slop matrix. weighted slop matrix, can explain severe spread occurs.   export tab, may directly download complete report matrixes. may also export N--N N--1 plots, quite big big panel. want plot N--N N--1 plots custom plot setting, need assign corresponding values UsermObj[[‚ÄúScale_df‚Äù]]. Otherwise, default setting used. Prediction one population possible. However, users need set intensities populations advance. predict 3 populations together.   3 populations shown together scatter plot. design interactive web similar PredOneSpread function.","code":"PredOneSpread(Userm = UsermObj,population_id = c(\"P1\")) UsermObj$Intensity_mtx[,2] = 200*c(1:length(UsermObj$fluors)) UsermObj$Intensity_mtx[,3] = 300*c(1:length(UsermObj$fluors)) names(UsermObj$Intensity_mtx) = c(\"P1\",\"P2\",\"P3\") PredMultipleSpread(Userm = UsermObj,population_ids = c(\"P1\",\"P2\",\"P3\"))"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"step-4-matrics-estimation-and-visualization","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"Step 4 matrics estimation and visualization","title":"Basic Instruction","text":"USERM supports multiple matrix tools panel design, including Coefficient Matrix, Hotspot Matrix, Similarity Matrix, Spread Distance Matrix. matrix can visualized Vis_Mtx function. estimate Coefficient Matrix:   Coefficient Matrix, high coef number indicates high increasing trend spread one fluorescence (row) another fluorescence (column), following increase fluorescence intensity. interpret high observed coef number related severe spread, researchers can use PredOneSpread function look underlying mechanical explanation potential solutions. detailed example provided another instruction. specific threshold ‚Äúbad‚Äù coef number ‚Äúgood‚Äù coef number. fluorescence intensity also matters varies different settings conjugated targets. However, Coef Matrix provides approach compare estimated spread panels. users can choose panel less expected spread. estimate Hotspot Matrix, signature matrix required:   Based paper Mage PL et al.2, diagonal entries Hotspot matrix informative, reflect degree fluorescence contributes unmixing-dependent spread. estimate Similarity Matrix, signature matrix required:   similarity matrix, number higher 0.98 indicates signals pair fluorescence well separated. , one needs replaced fluorescence. also possible estimate Spread Distance Matrix two populations estimated fluorescence intensities:   Spread Distance matrix, value < 1.0 indicates low resolution two cell populations. note, results accounts spread, originates instrumental noise deviations actual cellular emission average fluorescence signatures. Also, holds given fluorescence intensities.","code":"Coef_mtx = EstimateCoefMtx(Userm = UsermObj) Vis_Mtx(mat = Coef_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 2,mid = 1,min = 0,legend_name = \"Coef\",         title = \"Coefficient of residual model matrix (Coef Matrix) (row spread into column)\") Hotspot_mtx = EstimateHotspotMtx(A = UsermObj$A) Vis_Mtx(mat = Hotspot_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 2,mid = 1,min = 0,legend_name = \"Hotspot\",         title = \"Hotspot matrix\") Similarity_mtx = EstimateSimilarityMtx(A = UsermObj$A) Vis_Mtx(mat = Similarity_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 1,mid = 0.8,min = 0,legend_name = \"Cosine\",         title = \"Cosine similarity matrix\") Spr1 = EstimateSpread(Userm = UsermObj,population_id = c(\"P1\")) Spr2 = EstimateSpread(Userm = UsermObj,population_id = c(\"P2\")) SpreadDistance_mtx = EstimateDistance(Spr1, Spr2) Vis_Mtx(mat = SpreadDistance_mtx,mincolor = \"darkred\",midcolor = \"white\", maxcolor = \"white\",max = 1.5,mid = 1,min = 0,title = \"Spread Distance matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_basic.html","id":"citation","dir":"Articles","previous_headings":"Basic instruction for USERM use","what":"üìö Citation","title":"Basic Instruction","text":"use package research, please cite paper package :","code":"Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker, Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation. (to be update)  Cai X (2025). _USERM: Unmixing Spread Estimation with Residual Model_. R package version   1.0.0,  <https://github.com/xiangmingcai/USERM>.    @Manual{,     title = {USERM: Unmixing Spread Estimation with Residual Model},     author = {Xiangming Cai},     year = {2025},     note = {R package version 1.0.0},     url = {https://github.com/xiangmingcai/USERM},   }"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"instruction-for-userm-use-with-custom-sccs","dir":"Articles","previous_headings":"","what":"instruction for USERM use with Custom SCCs","title":"Use Custom SCC","text":"Xiangming Cai 2025-11-22","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"introduction","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"üîç Introduction","title":"Use Custom SCC","text":"USERM supports predicting spread unmixed spectral flow cytometry data, helps panel design interpratation unmixed results. 200 built-Single-color controls (SCCs) provided USERM. However, users can also apply USERM SCCs. helps users need specific fluorescence provided USERM, using instruments included USERM. instruction, show apply USERM custom SCCs. need first extract signatures SCCs prepare res objects SCC. , can easily predict custom SCCs (together built-SCCs).","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-0-load-packages-and-set-custom_dir","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"Step 0 üìà load packages and set custom_dir","title":"Use Custom SCC","text":"custom_dir store generated files, required prediction.","code":"# devtools::install_github(\"xiangmingcai/USERM\") library(USERM) library(flowCore) # devtools::install_github(\"xiangmingcai/GateData\") library(GateData) library(dplyr) library(ggplot2) library(MASS) library(circlize) library(ComplexHeatmap)  custom_dir = \"E:/MyFolder\" dir.create(paste0(custom_dir,\"/sig\")) dir.create(paste0(custom_dir,\"/res\"))"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-prepare-signature","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"Step 1 üìà Prepare signature","title":"Use Custom SCC","text":"need prepare signatures SCC seperately. steps extracting Autofluroescence (AF) almost , unless specified. Normally, unstained sample needed AF extraction. However, can extract AF negative population SCC unstained sample.","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-1-read-in-scc-fcs","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 1 üìà Prepare signature","what":"step 1.1 read in scc fcs","title":"Use Custom SCC","text":"","code":"data = read.FCS(\"E:/Data/SCC_Cell_CD2_SB780 Run 1 20251024102726.fcs\") #set the path to your SCC .fcs file # data = read.FCS(\"E:/Data/unstained_1 Run 1 20251024100712.fcs\") #this is for AF  print(head(data@parameters@data$desc)) print(head(data@parameters@data$name)) desc = data@parameters@data$desc # \"desc\" or \"name\" are used for different insruments. Ues the one with correct detector names.  data = exprs(data) data = as.data.frame(data) colnames(data) = desc head(data) > print(head(data@parameters@data$desc))        $P1S        $P2S        $P3S        $P4S        $P5S        $P6S       \"Time\"  \"Run Time\"  \"Event ID\" \"488 FSC-H\" \"488 FSC-A\" \"488 FSC-W\"  > print(head(data@parameters@data$name))       $P1N       $P2N       $P3N       $P4N       $P5N       $P6N      \"Time\" \"Run Time\" \"Event ID\"  \"FSC51-H\"  \"FSC51-A\"  \"FSC51-W\"   > head(data)   Time Run Time Event ID 488 FSC-H 488 FSC-A 488 FSC-W  488 FSC 488 SSC-H 488 SSC-A 488 SSC-W  488 SSC 488 FSC Polar-H 1  966      966        1  11053.84  11367.57  13671.88 11367.57  26975.94  27930.18  13671.88 27930.18        12814.00 2  991      991        2  46370.00  53884.65  15234.38 53884.65  92353.13  99999.98  16210.94 99999.98        54518.63 3 1066     1066        3  53632.18  60693.39  15039.06 60693.39  38315.37  43835.29  15039.06 43835.29        62066.83 4 1135     1135        4  56737.39  64002.36  15039.06 64002.36  37044.19  43117.40  15429.69 43117.40        66313.27 5 1233     1233        5  31609.00  36513.11  15429.69 36513.11  40273.66  46527.43  15039.06 46527.43        37028.07 6 1274     1274        6  21817.04  26400.30  16015.62 26400.30  55891.99  66402.58  15625.00 66402.58        24883.68 ...   405 FSC-A 405 FSC-W  405 FSC 405 SSC-H 405 SSC-A 405 SSC-W   405 SSC 349nm - 387/11-A 349nm - 387/11 349nm - 420/10-A 1  17551.05  13085.94 17551.05  9475.255  9475.971  13476.56  9475.971         2.872925       2.872925        6.1988525 2  57257.59  13671.88 57257.59 45441.043 53445.719  15234.38 53445.719         4.613342       4.613342        2.5987549 3  37115.38  13085.94 37115.38 14217.615 15710.759  14648.44 15710.759         2.360291       2.360291        8.5353394 4  46662.83  12500.00 46662.83 16527.271 18565.000  14843.75 18565.000         6.043884       6.043884        0.7271729 5  47614.96  11914.06 47614.96 15896.583 17418.504  14257.81 17418.504         1.561584       1.561584        1.0132446 6  46072.35  13476.56 46072.35 22898.090 27236.199  15625.00 27236.199         2.038452       2.038452        0.8344116 ..."},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-2-set-scc-fcs-info","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 1 üìà Prepare signature","what":"step 1.2 set scc fcs info","title":"Use Custom SCC","text":"may use public resource (e.g.¬†fluorofinder) find peak channel SCC. save_suf important name SCC, unique. recommended follow naming pattern shown . 4 elements name, separated underscore. first element ‚Äúbatch‚Äù element. built-SCCs use ‚ÄúSCC1‚Äù, ‚ÄúSCC2‚Äù, annotate SCC files acquired distinct batches.can use ‚ÄúSCCcustom‚Äù distinguish custom SCCs built-SCCs. can also use others makes sense . second element ‚Äútype‚Äù element. Now ‚ÄúCell‚Äù ‚ÄúBead‚Äù. third element ‚ÄúPrimaryName‚Äù. Normally put target antibody Ôºåe.g.¬†CD2. last element ‚ÄúSecondaryName‚Äù, Normally put fluroescence antibody , e.g.¬†SB780. Please avoid using space underscore elements.","code":"peak_channel = '405nm - 770/LP-A' # save_suf = \"SCCcustom_Cell_CD2_SB780\" PrimaryName = \"CD2\" SecondaryName = \"SB780\"  # save_suf = \"SCCcustom_Cell_AF_AF\" #For AF. # PrimaryName = \"AF\" #For AF. # SecondaryName = \"AF\" #For AF."},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-3-gate-positive-popualtion-and-negative-population","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 1 üìà Prepare signature","what":"step 1.3 gate positive popualtion and negative population","title":"Use Custom SCC","text":"step, need find positive negative populations. can use GateData R package packages works . show gate subset population GateData detailed instruction GateData, please refer https://github.com/xiangmingcai/GateData Brief instruction: draw gate, click 3 buttons order.","code":"# 1. sample cells. #You may modify code here to sample specific set for rare markers. data$gate0 = TRUE data = sample_n(data, 20000)  # 2. gate singlets if need # You can change the FSC and SSC names for specific instrument. # use colnames(data) to find available paramters # colnames(data) gate1<-PolygonGating(df=data, x_col= \"488 FSC-A\", y_col= \"488 FSC-H\", feature_col= \"488 FSC-A\",                      parentgate_col= \"gate0\", newgate_col= \"gate1\",canvas_width=800, canvas_height=400,                      title_text = \"Gate singlets\") data <-GateDecider(gate = gate1, df = data) gate2<-PolygonGating(df=data, x_col= \"488 SSC-A\", y_col= \"488 SSC-H\", feature_col= \"488 SSC-A\",                      parentgate_col= \"gate1\", newgate_col= \"gate2\",canvas_width=800, canvas_height=400,                      title_text = \"Gate singlets\") data <-GateDecider(gate = gate2, df = data) # 3. gate target population (e.g. lymphocytes) gate3<-PolygonGating(df=data, x_col= \"488 SSC-A\", y_col= \"488 FSC-A\", feature_col= \"488 SSC-A\",                      parentgate_col= \"gate2\", newgate_col= \"gate3\",canvas_width=800, canvas_height=500,                      title_text = \"Gate target population\") data <-GateDecider(gate = gate3, df = data) # 4. gate positive and negative populations. #For autofluorescence, randomly gate a negative populaiton and assign zero to it.  data = data[data$gate3,] gate_pos<-PolygonGating(df=data, x_col= peak_channel, y_col= \"488 SSC-A\", feature_col= \"488 SSC-A\",                         parentgate_col= \"gate3\", newgate_col= \"gate_pos\",canvas_width=800, canvas_height=400,                         title_text = \"Gate positive population\") data <-GateDecider(gate = gate_pos, df = data) gate_neg<-PolygonGating(df=data, x_col= peak_channel, y_col= \"488 SSC-A\", feature_col= \"488 SSC-A\",                         parentgate_col= \"gate3\", newgate_col= \"gate_neg\",canvas_width=800, canvas_height=400,                         title_text = \"Gate negative population\") data <-GateDecider(gate = gate_neg, df = data)  table(data$gate_pos) table(data$gate_neg) data_pos = data[data$gate_pos,] data_neg = data[data$gate_neg,]   # data_neg[,] <- 0 # For autofluorescence, assign zero to data_neg  # #you may save the gates if needed. # saveRDS(list(gate1,gate2,gate3,gate_pos,gate_neg), file = paste0(custom_dir,\"/\",save_suf,\"_gatelist.rds\")) # saveRDS(c(\"gate1\",\"gate2\",\"gate3\",\"gate_pos\",\"gate_neg\"), file = paste0(custom_dir,\"/\",save_suf,\"_gatenames.rds\")) > table(data$gate_pos)  FALSE  TRUE  11669   361  > table(data$gate_neg)  FALSE  TRUE   6202  5828"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-4-extract-signatures","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 1 üìà Prepare signature","what":"step 1.4 extract signatures","title":"Use Custom SCC","text":"","code":"#Select detectors. Please select only the detectors for unmixing colnames(data) cols = colnames(data)[seq(from=28, to=128, by=2)] print(cols)  Sig = ExtractSig(df_pos = data_pos,df_neg = data_neg,                  cols = cols, method = \"median\",                  PrimaryName = PrimaryName,                  SecondaryName = SecondaryName,                  id = save_suf,                  instrument = \"Xenith\",                  Source = \"YourName\",                  Note = NA)  #you may briefly check the signature df <- data.frame(Detector = names(Sig$Signature),Signal = as.numeric(Sig$Signature)) ggplot(df, aes(x = Detector, y = Signal, group = 1)) +   geom_line(color = \"steelblue\", linewidth = 1) +   geom_point(color = \"darkred\", size = 2) +   theme_minimal() +   theme(axis.text.x = element_text(angle = 90, hjust = 1)) +   labs(title = save_suf,        x = \"Detector\",        y = \"Signal\") > colnames(data)   [1] \"Time\"             \"Run Time\"         \"Event ID\"         \"488 FSC-H\"        \"488 FSC-A\"        \"488 FSC-W\"          [7] \"488 FSC\"          \"488 SSC-H\"        \"488 SSC-A\"        \"488 SSC-W\"        \"488 SSC\"          \"488 FSC Polar-H\"   [13] \"488 FSC Polar-A\"  \"488 FSC Polar-W\"  \"488 FSC Polar\"    \"488 SSC Polar-H\"  \"488 SSC Polar-A\"  \"488 SSC Polar-W\"   [19] \"488 SSC Polar\"    \"405 FSC-H\"        \"405 FSC-A\"        \"405 FSC-W\"        \"405 FSC\"          \"405 SSC-H\"         [25] \"405 SSC-A\"        \"405 SSC-W\"        \"405 SSC\"          \"349nm - 387/11-A\" \"349nm - 387/11\"   \"349nm - 420/10-A\"  [31] \"349nm - 420/10\"   \"349nm - 434/17-A\" \"349nm - 434/17\"   \"349nm - 455/14-A\" \"349nm - 455/14\"   \"349nm - 473/15-A\"  [37] \"349nm - 473/15\"   \"349nm - 507/19-A\" \"349nm - 507/19\"   \"349nm - 549/15-A\" \"349nm - 549/15\"   \"349nm - 575/15-A\"  [43] \"349nm - 575/15\"   \"349nm - 615/24-A\" \"349nm - 615/24\"   \"349nm - 670/30-A\" \"349nm - 670/30\"   \"349nm - 728/40-A\"  [49] \"349nm - 728/40\"   \"349nm - 810/25-A\" \"349nm - 810/25\"   \"405nm - 420/10-A\" \"405nm - 420/10\"   \"405nm - 434/17-A\"  [55] \"405nm - 434/17\"   \"405nm - 455/14-A\" \"405nm - 455/14\"   \"405nm - 473/15-A\" \"405nm - 473/15\"   \"405nm - 507/19-A\"  [61] \"405nm - 507/19\"   \"405nm - 549/15-A\" \"405nm - 549/15\"   \"405nm - 575/15-A\" \"405nm - 575/15\"   \"405nm - 615/24-A\"  [67] \"405nm - 615/24\"   \"405nm - 661/20-A\" \"405nm - 661/20\"   \"405nm - 710/20-A\" \"405nm - 710/20\"   \"405nm - 747/33-A\"  [73] \"405nm - 747/33\"   \"405nm - 770/LP-A\" \"405nm - 770/LP\"   \"488nm - 520/40-A\" \"488nm - 520/40\"   \"488nm - 549/15-A\"  [79] \"488nm - 549/15\"   \"488nm - 583/30-A\" \"488nm - 583/30\"   \"488nm - 615/24-A\" \"488nm - 615/24\"   \"488nm - 670/30-A\"  [85] \"488nm - 670/30\"   \"488nm - 720/24-A\" \"488nm - 720/24\"   \"488nm - 750/LP-A\" \"488nm - 750/LP\"   \"561nm - 575/15-A\"  [91] \"561nm - 575/15\"   \"561nm - 589/15-A\" \"561nm - 589/15\"   \"561nm - 605/15-A\" \"561nm - 605/15\"   \"561nm - 622/15-A\"  [97] \"561nm - 622/15\"   \"561nm - 661/20-A\" \"561nm - 661/20\"   \"561nm - 685/15-A\" \"561nm - 685/15\"   \"561nm - 700/13-A\" [103] \"561nm - 700/13\"   \"561nm - 720/24-A\" \"561nm - 720/24\"   \"561nm - 760/50-A\" \"561nm - 760/50\"   \"561nm - 810/25-A\" [109] \"561nm - 810/25\"   \"561nm - 844/25-A\" \"561nm - 844/25\"   \"561nm - 860/LP-A\" \"561nm - 860/LP\"   \"637nm - 661/20-A\" [115] \"637nm - 661/20\"   \"637nm - 700/13-A\" \"637nm - 700/13\"   \"637nm - 720/24-A\" \"637nm - 720/24\"   \"637nm - 760/50-A\" [121] \"637nm - 760/50\"   \"637nm - 785/LP-A\" \"637nm - 785/LP\"   \"781nm - 810/25-A\" \"781nm - 810/25\"   \"781nm - 844/25-A\" [127] \"781nm - 844/25\"   \"781nm - 860/LP-A\" \"781nm - 860/LP\"   \"GateMatch\"        \"SortIndex\"        \"DropsSorted\"      [133] \"SortDestination\"  \"gate0\"            \"gate1\"            \"gate2\"            \"gate3\"            \"gate_pos\"         [139] \"gate_neg\"          > print(cols)  [1] \"349nm - 387/11-A\" \"349nm - 420/10-A\" \"349nm - 434/17-A\" \"349nm - 455/14-A\" \"349nm - 473/15-A\" \"349nm - 507/19-A\"  [7] \"349nm - 549/15-A\" \"349nm - 575/15-A\" \"349nm - 615/24-A\" \"349nm - 670/30-A\" \"349nm - 728/40-A\" \"349nm - 810/25-A\" [13] \"405nm - 420/10-A\" \"405nm - 434/17-A\" \"405nm - 455/14-A\" \"405nm - 473/15-A\" \"405nm - 507/19-A\" \"405nm - 549/15-A\" [19] \"405nm - 575/15-A\" \"405nm - 615/24-A\" \"405nm - 661/20-A\" \"405nm - 710/20-A\" \"405nm - 747/33-A\" \"405nm - 770/LP-A\" [25] \"488nm - 520/40-A\" \"488nm - 549/15-A\" \"488nm - 583/30-A\" \"488nm - 615/24-A\" \"488nm - 670/30-A\" \"488nm - 720/24-A\" [31] \"488nm - 750/LP-A\" \"561nm - 575/15-A\" \"561nm - 589/15-A\" \"561nm - 605/15-A\" \"561nm - 622/15-A\" \"561nm - 661/20-A\" [37] \"561nm - 685/15-A\" \"561nm - 700/13-A\" \"561nm - 720/24-A\" \"561nm - 760/50-A\" \"561nm - 810/25-A\" \"561nm - 844/25-A\" [43] \"561nm - 860/LP-A\" \"637nm - 661/20-A\" \"637nm - 700/13-A\" \"637nm - 720/24-A\" \"637nm - 760/50-A\" \"637nm - 785/LP-A\" [49] \"781nm - 810/25-A\" \"781nm - 844/25-A\" \"781nm - 860/LP-A\""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-1-5-add-signatures-to-custom_sig_list","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 1 üìà Prepare signature","what":"step 1.5 add signatures to Custom_Sig_list","title":"Use Custom SCC","text":"end, Custom_Sig_list containing elements like :   SCCs, elements Custom_Sig_list.","code":"# 1. Read in Custom_Sig_list #For first SCC (that means you do not have a Custom_Sig_list yet) Custom_Sig_list = list() #If you already have a Custom_Sig_list Custom_Sig_list = readRDS(paste0(custom_dir,\"/sig/Custom_Sig_list.rds\"))  # 2. add signatures to Custom_Sig_list Custom_Sig_list[[length(Custom_Sig_list)+1]] = Sig names(Custom_Sig_list)[length(Custom_Sig_list)] = Custom_Sig_list[[length(Custom_Sig_list)]]$id  # You may delete a certain Sig from the Custom_Sig_list using this code: # Custom_Sig_list[[length(Custom_Sig_list)]] = NULL  # 3. save updated Custom_Sig_list saveRDS(Custom_Sig_list, file = paste0(custom_dir,\"/sig/Custom_Sig_list.rds\"))"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-prepare-res-obj","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"Step 2 üìà Prepare res obj","title":"Use Custom SCC","text":"Now least one SCC signature one AF signature(necessary res obj preparation) Custom_Sig_list. , can proceed prpare res obj fluorescence, including AF.","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-1-read-custom_sig_list-and-prepare-sig_mtx","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.1 read Custom_Sig_list and prepare Sig_mtx","title":"Use Custom SCC","text":"need select target fluorescence, including AF. order matter now, since assign target index AF index later.","code":"Custom_Sig_list = readRDS(paste0(custom_dir,\"/sig/Custom_Sig_list.rds\"))  Sig_info = querySig(Sig_list = Custom_Sig_list) fluors_selected = c(Sig_info$id[c(1,2)]) print(fluors_selected) Sig_mtx  = getSigMtx(ids = fluors_selected, Sig_list = Custom_Sig_list) > fluors_selected [1] \"SCCcustom_Cell_CD2_SB780\" \"SCCcustom_Cell_AF_AF\""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-2-read-scc-fcs","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.2 read scc fcs","title":"Use Custom SCC","text":"","code":"data = read.FCS(\"E:/Data/SCC_Cell_CD2_SB780 Run 1 20251024102726.fcs\") # data = read.FCS(\"E:/Data/unstained_1 Run 1 20251024100712.fcs\") #For AF  print(head(data@parameters@data$desc)) print(head(data@parameters@data$name)) desc = data@parameters@data$desc # \"desc\" or \"name\" are used for different insruments. Ues the one with correct detector names.  data = exprs(data) data = as.data.frame(data) colnames(data) = desc head(data)"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-3-set-target-and-af-info","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.3 set target and AF info","title":"Use Custom SCC","text":"need choose index (idx) target fluorescence corresponding AF. example, want prepare res obj SCCcustom_Cell_CD2_SB780 first. assign index ‚ÄúSCCcustom_Cell_CD2_SB780‚Äù idx_target_fluor. ‚ÄúSCCcustom_Cell_AF_AF‚Äù used corrsponding AF. want prepare res obj AF. can simply assign index AF idx_target_fluor, use index idx_AF_fluor.","code":"print(colnames(Sig_mtx))  save_suf = \"SCCcustom_Cell_CD2_SB780\" idx_target_fluor = 1 idx_AF_fluor = 2  # For AF # save_suf = \"SCCcustom_Cell_AF_AF\" # idx_target_fluor = 2 # idx_AF_fluor = 1 #For AF, use any other scc here  #check if the idx are correct print(colnames(Sig_mtx)[idx_target_fluor]) print(colnames(Sig_mtx)[idx_AF_fluor]) > print(colnames(Sig_mtx)) [1] \"SCCcustom_Cell_CD2_SB780\" \"SCCcustom_Cell_AF_AF\"   > colnames(Sig_mtx)[idx_target_fluor] [1] \"SCCcustom_Cell_CD2_SB780\"  > colnames(Sig_mtx)[idx_AF_fluor] [1] \"SCCcustom_Cell_AF_AF\""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-4-gate-siglets-and-target-population","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.4 gate siglets and target population","title":"Use Custom SCC","text":"want use many cells possible calculate parameters res obj. However, need gate required cells first. speed gating step, can use sampled subset make gates subset cells.","code":"# 1. sample cells. #You may modify code here to sample specific set for rare markers. data$gate0 = TRUE data_backup = data  data = sample_n(data, 20000)  # 2. gate singlets if need #You can change the FSC and SSC names for specific instrument. # use colnames(data) to find available paramters # colnames(data) gate1<-PolygonGating(df=data, x_col= \"488 FSC-A\", y_col= \"488 FSC-H\", feature_col= \"488 FSC-A\",                      parentgate_col= \"gate0\", newgate_col= \"gate1\",canvas_width=800, canvas_height=400,                      title_text = \"Gate singlets\") data <-GateDecider(gate = gate1, df = data) gate2<-PolygonGating(df=data, x_col= \"488 SSC-A\", y_col= \"488 SSC-H\", feature_col= \"488 SSC-A\",                      parentgate_col= \"gate1\", newgate_col= \"gate2\",canvas_width=800, canvas_height=400,                      title_text = \"Gate singlets\") data <-GateDecider(gate = gate2, df = data)  # 3. gate target population (e.g. lymphocytes) gate3<-PolygonGating(df=data, x_col= \"488 SSC-A\", y_col= \"488 FSC-A\", feature_col= \"488 SSC-A\",                      parentgate_col= \"gate2\", newgate_col= \"gate3\",canvas_width=1500, canvas_height=1500,                      title_text = \"Gate target population\") data <-GateDecider(gate = gate3, df = data)  # 4. subset with all cells data = data_backup data <-GateDecider(gate = gate1, df = data) data <-GateDecider(gate = gate2, df = data) data <-GateDecider(gate = gate3, df = data) data = data[data$gate3,]"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-5-unmix-with-target_fluor-and-af","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.5 unmix with target_fluor and AF","title":"Use Custom SCC","text":"","code":"data = data[,rownames(Sig_mtx)] #cells x detectors R = t(as.matrix(data)) # detectors x cells A = Sig_mtx[,c(idx_target_fluor,idx_AF_fluor), drop = FALSE] # detectors x fluors A_pinv = ginv(A) B =  A_pinv %*% R t_B = t(B) colnames(t_B) = c(colnames(Sig_mtx)[idx_target_fluor],colnames(Sig_mtx)[idx_AF_fluor]) data = cbind(data,t_B)"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-2-6-gate-normal-samples","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"step 2.6 gate normal samples","title":"Use Custom SCC","text":"common find outliers weird populations SCC sample. However, need stable positive population, wide range possible. need gate normal population need. High quality data needed, means cells/beads intensity ranges form low high value covers estiamted intensity. Also, important enough amount sample size robust estimation. higher robust, > 10000 cells recommended. outlier makes gating difficult, may remove outliers first.   gate normal population AF, just need gate stable negative populaiton:","code":"# You may remove some outliers for easier gating # data = data[(data[,colnames(Sig_mtx)[idx_target_fluor]] < #                quantile(data[,colnames(Sig_mtx)[idx_target_fluor]],0.999)),] # data = data[(data[,colnames(Sig_mtx)[idx_target_fluor]] > #                quantile(data[,colnames(Sig_mtx)[idx_target_fluor]],0.01)),]  data$gate0 = TRUE data_backup = data data = sample_n(data, 20000) gate_normal<-PolygonGating(df=data, x_col= colnames(Sig_mtx)[idx_target_fluor],                            y_col= colnames(Sig_mtx)[idx_AF_fluor],                            feature_col= colnames(Sig_mtx)[idx_target_fluor],                            parentgate_col= \"gate0\", newgate_col= \"gate_normal\",canvas_width=800, canvas_height=400) data = data_backup data = GateDecider(gate = gate_normal, df = data) data = data[data$gate_normal,rownames(Sig_mtx)]  #you may save gate_normal is you want # saveRDS(list(gate_normal), file = paste0(custom_dir,\"/\",save_suf,\"_gatelist.rds\")) # saveRDS(c(\"gate_normal\"), file = paste0(custom_dir,\"/\",save_suf,\"_gatenames.rds\"))"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"calculate-and-save-residual-model","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 2 üìà Prepare res obj","what":"2.7 calculate and save residual model","title":"Use Custom SCC","text":"generated ResObj contains details, used prediction.","code":"R = as.matrix(data) A_Target = Sig_mtx[,c(idx_target_fluor), drop = FALSE] A_AF = Sig_mtx[,c(idx_AF_fluor), drop = FALSE]  ResObj = CreateRes(id = colnames(Sig_mtx)[idx_target_fluor], R = R, A_Target = A_Target, A_AF = A_AF)  ResObj = SlopEstimation(Res = ResObj, bin_num = 30)  #You may briefly visualize the slope matrix col_fun = colorRamp2(c(-1, 0, 1), c(\"blue\", \"white\", \"red\")) Heatmap(ResObj$slopMtx,col = col_fun, cluster_rows = FALSE,cluster_columns = FALSE,         cell_fun = function(j, i, x, y, width, height, fill) {           grid.text(sprintf(\"%.1f\", ResObj$slopMtx[i, j]), x, y, gp = gpar(fontsize = 6))         },column_title = colnames(Sig_mtx)[idx_target_fluor],name = \"beta\")  saveRDS(ResObj, file = paste0(custom_dir,\"/res\",\"/ResObj_\",save_suf,\".rds\")) > ResObj = SlopEstimation(Res = ResObj, bin_num = 30) calculating cov matrix... (-) [===============================] 100% [Elapsed time: 00:00:09 || Estimated time remaining:  0s] calculating slop matrix..."},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-3-use-custom-res-obj-and-built-in-res-obj-together-to-make-spread-prediction","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"Step 3 Use custom res obj and built-in res obj together to make spread prediction","title":"Use Custom SCC","text":"res obj custom SCC ready, can make prediction! falimilar basic use USERM, easy adapt custom SCC. , please try built-SCC first instruction. show use custom SCC built-SCC together. use custom SCC, just ignore code built-SCC. Note: custom_dir contains following files now: Remember keep files, need generate next time!","code":"MyFolder/ ‚îú‚îÄ‚îÄ res/                   ‚îÇ   ‚îú‚îÄ‚îÄ ResObj_SCCcustom_Cell_AF_AF.rds           ‚îÇ   ‚îî‚îÄ‚îÄ ResObj_SCCcustom_Cell_CD2_SB780.rds ‚îú‚îÄ‚îÄ sig/                   ‚îÇ   ‚îî‚îÄ‚îÄ Custom_Sig_list.rds"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-3-1-check-available-custom-fluorescence","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 3 Use custom res obj and built-in res obj together to make spread prediction","what":"step 3.1 check available custom fluorescence","title":"Use Custom SCC","text":"First, read Custom_Sig_list. can check signature fluorescence interest. can also check res obj interested fluorescence.","code":"Custom_Sig_list = readRDS(paste0(custom_dir,\"/sig/Custom_Sig_list.rds\")) Custom_Sig_info = querySig(Sig_list = Custom_Sig_list) fluor_to_check = Custom_Sig_info$id[1] print(fluor_to_check)  checkSig_linePlot(id = fluor_to_check, Sig_list = Custom_Sig_list) > print(fluor_to_check) [1] \"SCCcustom_Cell_CD2_SB780\" #get Residual Obj ResObj = getRes(id = fluor_to_check,custom_dir = paste0(custom_dir,\"/res\"))  checkRes_slopMtx(Res = ResObj) checkRes_interceptMtx(Res = ResObj) print(ResObj$bin_mids) checkRes_covMtx(Res = ResObj,bin=3) ResObj$detectors checkRes_covScatter(Res = ResObj,                     detector1 = ResObj$detectors[1],                     detector2 = ResObj$detectors[2])"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-3-2-select-fluors-and-create-usermobj","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 3 Use custom res obj and built-in res obj together to make spread prediction","what":"step 3.2 Select fluors and create UsermObj","title":"Use Custom SCC","text":"want use built-fluorescence, can select well. Now can bind 2 Sig_mtx, add res obj UsermObj one one.","code":"Custom_fluors_selected = c(Custom_Sig_info$id[c(1,2)]) print(Custom_fluors_selected) Custom_Sig_mtx  = getSigMtx(ids = Custom_fluors_selected,Sig_list = Custom_Sig_list) dim(Custom_Sig_mtx) > print(Custom_fluors_selected) [1] \"SCCcustom_Cell_CD2_SB780\" \"SCCcustom_Cell_AF_AF\"   > dim(Custom_Sig_mtx) [1] 51  2 builtin_Sig_info = querySig() builtin_fluors_selected = c(builtin_Sig_info$id[c(34,35,36)]) print(builtin_fluors_selected) builtin_Sig_mtx  = getSigMtx(ids = builtin_fluors_selected) dim(builtin_Sig_mtx) > print(builtin_fluors_selected) [1] \"SCC_Cell_CD3_BV510\"  \"SCC_Cell_CD4_NFR700\" \"SCC_Cell_CD8_BV570\"   > dim(builtin_Sig_mtx) [1] 51  3 Sig_mtx = cbind(builtin_Sig_mtx,Custom_Sig_mtx)  UsermObj = CreateUserm(A = Sig_mtx) #add ResObj into UsermObj for (save_suf in colnames(builtin_Sig_mtx)) {   ResObj = getRes(id = save_suf)   UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj) } for (save_suf in colnames(Custom_Sig_mtx)) {   ResObj = getRes(id = save_suf,custom_dir = paste0(custom_dir,\"/res\"))   UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj) }"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"step-3-3-prediction","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs > Step 3 Use custom res obj and built-in res obj together to make spread prediction","what":"step 3.3 prediction","title":"Use Custom SCC","text":"Prediction basic use. show simple case. can explore data ready.","code":"PredOneSpread(Userm = UsermObj,population_id = c(\"P1\")) UsermObj$Intensity_mtx[,1] = 0 UsermObj$Intensity_mtx[,2] = UsermObj$Intensity_mtx[,1] UsermObj$Intensity_mtx[,3] = UsermObj$Intensity_mtx[,1]  UsermObj$Intensity_mtx[4,1] = 100 UsermObj$Intensity_mtx[4,2] = 500 UsermObj$Intensity_mtx[4,3] = 1000  names(UsermObj$Intensity_mtx) = c(\"P1\",\"P2\",\"P3\") PredMultipleSpread(Userm = UsermObj,population_ids = c(\"P1\",\"P2\",\"P3\")) Coef_mtx = EstimateCoefMtx(Userm = UsermObj) Vis_Mtx(mat = Coef_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 20,mid = 10,min = 0,legend_name = \"Coef\",         title = \"Coefficient of residual model matrix (Coef Matrix) (row spread into column)\") Hotspot_mtx = EstimateHotspotMtx(A = UsermObj$A) Vis_Mtx(mat = Hotspot_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 2,mid = 1,min = 0,legend_name = \"Hotspot\",         title = \"Hotspot matrix\") Similarity_mtx = EstimateSimilarityMtx(A = UsermObj$A) Vis_Mtx(mat = Similarity_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 1,mid = 0.8,min = 0,legend_name = \"Cosine\",         title = \"Cosine similarity matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_customFCS.html","id":"citation","dir":"Articles","previous_headings":"instruction for USERM use with Custom SCCs","what":"üìö Citation","title":"Use Custom SCC","text":"use package research, please cite paper package :","code":"Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker, Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation. (to be update)  Cai X (2025). _USERM: Unmixing Spread Estimation with Residual Model_. R package version   1.0.0,  <https://github.com/xiangmingcai/USERM>.    @Manual{,     title = {USERM: Unmixing Spread Estimation with Residual Model},     author = {Xiangming Cai},     year = {2025},     note = {R package version 1.0.0},     url = {https://github.com/xiangmingcai/USERM},   }"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"interprate-the-observed-spread-with-userm","dir":"Articles","previous_headings":"","what":"Interprate the observed spread with USERM","title":"Interprate Spread","text":"Xiangming Cai 2025-11-22","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"introduction","dir":"Articles","previous_headings":"Interprate the observed spread with USERM","what":"üîç Introduction","title":"Interprate Spread","text":"instruction show case interprate high Coef value found Coef Matrix. note, show check reason observed high spread. Strategy panel adjustment scope instruction. basic instruction USERM, please refer basic instruction.","code":""},{"path":[]},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"create-a-panel","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > üíª An example with high Coef value","what":"create a panel","title":"Interprate Spread","text":"use USERM make 20 color + AF panel Aurora 5L.   Coef Matrix, find high Coef value PECy7 spread BV510, equals 71.3. contrary, coef value PECy7 spread BV480 low, equals 1.0.","code":"library(USERM) # Step 1 querySig Sig_info = querySig() head(Sig_info)  # Step 2 Select fluors and create UsermObj fluors_selected = c(Sig_info$id[c(149,201,150,151,                                   152,153,154,155,                                   156,157,158,159,                                   160,161,162,163,                                   189,200,196,199,138)]) print(fluors_selected) Sig_mtx  = getSigMtx(ids = fluors_selected) dim(Sig_mtx)  UsermObj = CreateUserm(A = Sig_mtx) #add ResObj into UsermObj for (save_suf in colnames(Sig_mtx)) {   ResObj = getRes(id = save_suf)   UsermObj = AddRes2Userm(Res = ResObj, Userm = UsermObj) }  # Step 4 matrics estimation and visualization Coef_mtx = EstimateCoefMtx(Userm = UsermObj) Vis_Mtx(mat = Coef_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 20,mid = 10,min = 0,legend_name = \"Coef\",         title = \"Coefficient of residual model matrix (Coef Matrix) (row spread into column)\") > head(Sig_info)                     id PrimaryName SecondaryName detectors instrument       Source Note 1  SCC_Bead_CD4_NFR700         CD4        NFR700        51     Xenith XiangmingCai   NA 2   SCC_Bead_CD3_BV510         CD3         BV510        51     Xenith XiangmingCai   NA 3    SCC_Bead_CD2_FITC         CD2          FITC        51     Xenith XiangmingCai   NA 4       SCC_Bead_AF_AF          AF            AF        51     Xenith XiangmingCai   NA 5   SCC_Bead_CD8_BV570         CD8         BV570        51     Xenith XiangmingCai   NA 6 SCC_Bead_CD16_BUV805        CD16        BUV805        51     Xenith XiangmingCai   NA  > print(fluors_selected)  [1] \"SCC3_Cell_BUV395_CD4\"    \"SCC3_Cell_LDBlue_LD\"     \"SCC3_Cell_BUV496_CD4\"     [4] \"SCC3_Cell_BUV563_CD4\"    \"SCC3_Cell_BUV615_CD4\"    \"SCC3_Cell_BUV661_CD4\"     [7] \"SCC3_Cell_BUV737_CD4\"    \"SCC3_Cell_BUV805_CD4\"    \"SCC3_Cell_BV421_CD4\"     [10] \"SCC3_Cell_BV480_CD4\"     \"SCC3_Cell_BV510_CD4\"     \"SCC3_Cell_BV605_CD4\"     [13] \"SCC3_Cell_BV650_CD4\"     \"SCC3_Cell_BV711_CD4\"     \"SCC3_Cell_BV750_CD4\"     [16] \"SCC3_Cell_BV786_CD4\"     \"SCC3_Cell_FITC_CD4\"      \"SCC3_Cell_PerCPCy55_CD4\" [19] \"SCC3_Cell_PE_CD4\"        \"SCC3_Cell_PECy7_CD4\"     \"SCC3_Cell_AF_AF\"    > dim(Sig_mtx) [1] 64 21"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"verify-the-high-coef-value","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > üíª An example with high Coef value","what":"verify the high coef value","title":"Interprate Spread","text":"first verify spread single-color control (SCC) setting (PECy7). use USERM look reason high coef value, can understand high spread PECy7 BV510. make single-color control setting, can create 3 SCC populations first. Now, can predict spread 3 populations. Set Factor default Autofluorescence 0, remove spread intercept matrix, represents spread AF. Adjust range axes can saw predicted plot:   plot shows increasing trend spread PECy7 BV510 fluorescence intensity PECy7 increases. Now can switch x axis BV480.   plot, clear PECy7 barely spread BV480, compared BV510. observation verify find coef matrix. New want know high spread PECy7 BV510.","code":"#create 3 populations with all zero fluroescence intensities UsermObj$Intensity_mtx[,1] = 0 UsermObj$Intensity_mtx[,2] = UsermObj$Intensity_mtx[,1] UsermObj$Intensity_mtx[,3] = UsermObj$Intensity_mtx[,1] # assign 100, 500, 1000 to the PECy7 intensities of these 3 populations UsermObj$Intensity_mtx[20,1] = 100 UsermObj$Intensity_mtx[20,2] = 500 UsermObj$Intensity_mtx[20,3] = 1000 print(UsermObj[[\"Intensity_mtx\"]]) > print(UsermObj[[\"Intensity_mtx\"]])                          V1  V2   V3 SCC3_Cell_BUV395_CD4      0   0    0 SCC3_Cell_LDBlue_LD       0   0    0 SCC3_Cell_BUV496_CD4      0   0    0 SCC3_Cell_BUV563_CD4      0   0    0 SCC3_Cell_BUV615_CD4      0   0    0 SCC3_Cell_BUV661_CD4      0   0    0 SCC3_Cell_BUV737_CD4      0   0    0 SCC3_Cell_BUV805_CD4      0   0    0 SCC3_Cell_BV421_CD4       0   0    0 SCC3_Cell_BV480_CD4       0   0    0 SCC3_Cell_BV510_CD4       0   0    0 SCC3_Cell_BV605_CD4       0   0    0 SCC3_Cell_BV650_CD4       0   0    0 SCC3_Cell_BV711_CD4       0   0    0 SCC3_Cell_BV750_CD4       0   0    0 SCC3_Cell_BV786_CD4       0   0    0 SCC3_Cell_FITC_CD4        0   0    0 SCC3_Cell_PerCPCy55_CD4   0   0    0 SCC3_Cell_PE_CD4          0   0    0 SCC3_Cell_PECy7_CD4     100 500 1000 SCC3_Cell_AF_AF           0   0    0 PredMultipleSpread(Userm = UsermObj,population_ids = c(\"V1\",\"V2\",\"V3\"))"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"why-there-is-a-high-spread","dir":"Articles","previous_headings":"Interprate the observed spread with USERM","what":"Why there is a high spread?","title":"Interprate Spread","text":"Let‚Äôs first take look key part residual model1, used predict spread SCC fluorescence h (PECy7) fluorescence k (BV510):   formulation,  intensity fluroescence h.  pseudo-inverse signature matrix .  k-th row pseudo-inverse .  slope matrix (explain later).  transpose . multiplied results predicted spread fluorescence h fluorescence k. detailed explanation Matrix multiplication, please check Matrix multiplication Now, let‚Äôs visualize matrixes clear understanding . circle key components matrixes.","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"signature-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread?","what":"1. signature matrix","title":"Interprate Spread","text":"can first visualize signature matrix, simply signatures fluorescence panel.","code":"A = UsermObj$A Vis_Mtx(mat = A,mincolor = \"white\",midcolor = \"#D03E4C\", maxcolor = \"#B02B38\",         max = 1,mid = 0.5,min = 0,legend_name = \"Signal\",         title = \"Signature matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"pseudo-inverse-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread?","what":"2. pseudo-inverse matrix","title":"Interprate Spread","text":"Now, calculate pseudo-inverse signature matrix. detailed explanation pseudo-inverse, please check Generalized-inverse   circled line .","code":"library(MASS) A_pinv = ginv(A) colnames(A_pinv) = rownames(A) rownames(A_pinv) = colnames(A) Vis_Mtx(mat = A_pinv,mincolor = \"#95ABDB\",midcolor = \"white\", maxcolor = \"#B02B38\",         max = 1,mid = 0,min = -1,legend_name = \"Value\",         title = \"Pseudo-inverse matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"slope-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread?","what":"3. slope matrix","title":"Interprate Spread","text":"Following order components formula, can now visualize slope matrix fluorescence h:   whole matrix slope matrix. slope matrix m detectors x m detectors matrix. detector residual signals (see 2), accounts spread fluroescence k. covariance detector detector j calculated. covariance linearly related intensity fluorescence h. linear model fit describe relationship generate slope value (beta). , slope matrix, slope value represents linear relationship covariance corresponding pair detectors versus intensity fluorescence h. can visualized linear relationship covariance B13-B14-versus fluorescence intensity fluorescence h (PECy7):","code":"slop_mtx = UsermObj$Res$SCC3_Cell_PECy7_CD4$slopMtx Vis_Mtx(mat = slop_mtx,mincolor = \"#95ABDB\",midcolor = \"white\", maxcolor = \"#B02B38\",         max = 1,mid = 0,min = -1,legend_name = \"beta\",         title = \"slope matrix\") ResObj = UsermObj$Res$SCC3_Cell_PECy7_CD4 ResObj$detectors checkRes_covScatter(Res = ResObj,                     detector1 = \"B13-A\",                     detector2 = \"B14-A\") > ResObj$detectors  [1] \"UV1-A\"  \"UV2-A\"  \"UV3-A\"  \"UV4-A\"  \"UV5-A\"  \"UV6-A\"  \"UV7-A\"  \"UV8-A\"  \"UV9-A\"  \"UV10-A\" \"UV11-A\" [12] \"UV12-A\" \"UV13-A\" \"UV14-A\" \"UV15-A\" \"UV16-A\" \"V1-A\"   \"V2-A\"   \"V3-A\"   \"V4-A\"   \"V5-A\"   \"V6-A\"   [23] \"V7-A\"   \"V8-A\"   \"V9-A\"   \"V10-A\"  \"V11-A\"  \"V12-A\"  \"V13-A\"  \"V14-A\"  \"V15-A\"  \"V16-A\"  \"B1-A\"   [34] \"B2-A\"   \"B3-A\"   \"B4-A\"   \"B5-A\"   \"B6-A\"   \"B7-A\"   \"B8-A\"   \"B9-A\"   \"B10-A\"  \"B11-A\"  \"B12-A\"  [45] \"B13-A\"  \"B14-A\"  \"YG1-A\"  \"YG2-A\"  \"YG3-A\"  \"YG4-A\"  \"YG5-A\"  \"YG6-A\"  \"YG7-A\"  \"YG8-A\"  \"YG9-A\"  [56] \"YG10-A\" \"R1-A\"   \"R2-A\"   \"R3-A\"   \"R4-A\"   \"R5-A\"   \"R6-A\"   \"R7-A\"   \"R8-A\""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"transpose-of-the-pseudo-inverse-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread?","what":"4. transpose of the pseudo-inverse matrix","title":"Interprate Spread","text":"Now, continue last component formula, transpose pseudo-inverse matrix:   circled column .","code":"A_pinv_t = t(A_pinv) Vis_Mtx(mat = A_pinv_t,mincolor = \"#95ABDB\",midcolor = \"white\", maxcolor = \"#B02B38\",         max = 1,mid = 0,min = -1,legend_name = \"Value\",         title = \"transpose of Pseudo-inverse matrix\")"},{"path":[]},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"reshape-formula","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 5. sum of the weighted slope matrix represents the observed spread","what":"5.1 reshape formula","title":"Interprate Spread","text":"indices j represents -th row j-th column slope matrix. formula can interpreted sum weighted slope matrix, weight product -th j-th values .","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"weight-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 5. sum of the weighted slope matrix represents the observed spread","what":"5.2 weight matrix","title":"Interprate Spread","text":"can compute weight matrix, value -th row j-th column product -th j-th value  :   can immediately find values weight matrix zero. detailed explanation outer product conducted , please check Outer Product","code":"weight_mtx = A_pinv[\"SCC3_Cell_BV510_CD4\",] %o% A_pinv[\"SCC3_Cell_BV510_CD4\",] Vis_Mtx(mat = weight_mtx,mincolor = \"#95ABDB\",midcolor = \"white\", maxcolor = \"#B02B38\",         max = 1,mid = 0,min = -1,legend_name = \"weight\",         title = \"weight matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"weighted-slope-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 5. sum of the weighted slope matrix represents the observed spread","what":"5.3 weighted slope matrix","title":"Interprate Spread","text":"can visualize weighted slope matrix:   sum values weighted slope matrix predicted spread fluorescence h fluorescence k. values can negative, 0, positive. obvious values contribute overall sum. contributing values correspond detector pairs B12-, B13-, B14-, YG10-. conclusion, high spread fluorescence h (PECy7) fluorescence k (BV510) related circled value peseudo-inverse matrix slop matrix. another word, influenced overall signature matrix, also linear relationship covariance among residual signals detector B12-, B13-, B14-, YG10-intensity fluorescence h (PECy7).","code":"weighted_slope_mtx = weight_mtx * slop_mtx Vis_Mtx(mat = weighted_slope_mtx,mincolor = \"#95ABDB\",midcolor = \"white\", maxcolor = \"#B02B38\",         max = 10,mid = 0,min = -10,legend_name = \"value\",         title = \"weighted slop matrix\") sum(weighted_slope_mtx) > sum(weighted_slope_mtx) [1] 71.32371"},{"path":[]},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"fluorescence-signature","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 6. compare the coef with other tools","what":"6.1 fluorescence signature","title":"Interprate Spread","text":"can check signature PECy7:   peak channels appear related conclusion, although connection remains unclear.","code":"checkSig_linePlot(id = \"SCC3_Cell_PECy7_CD4\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"similarity-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 6. compare the coef with other tools","what":"6.2 similarity matrix","title":"Interprate Spread","text":"check similarity matrix:   clear conflicting fluorescence found.","code":"Similarity_mtx = EstimateSimilarityMtx(A = UsermObj$A) Vis_Mtx(mat = Similarity_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 1,mid = 0.8,min = 0,legend_name = \"Cosine\",         title = \"Cosine similarity matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"hotspot-matrix","dir":"Articles","previous_headings":"Interprate the observed spread with USERM > Why there is a high spread? > 6. compare the coef with other tools","what":"6.3 Hotspot matrix","title":"Interprate Spread","text":"check Hotspot matrix:   spread PECy7 BV510 identified.","code":"Hotspot_mtx = EstimateHotspotMtx(A = UsermObj$A) # pdf(file = \"E:/ResidualModel/HotspotMtx.pdf\",width = 10,height = 10) Vis_Mtx(mat = Hotspot_mtx,mincolor = \"white\",midcolor = \"white\", maxcolor = \"#95ABDB\",         max = 2,mid = 1,min = 0,legend_name = \"Hotspot\",         title = \"Hotspot matrix\")"},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"perspective","dir":"Articles","previous_headings":"Interprate the observed spread with USERM","what":"Perspective","title":"Interprate Spread","text":"think Coef Matrix can good complementary available tools. want encourage researchers use tools panel design optimize unmixed results possible. USERM package can --box tool apply commonly used tools makes panel design better.","code":""},{"path":"https://xiangmingcai.github.io/USERM/articles/instruction_interprateHighCoef.html","id":"citation","dir":"Articles","previous_headings":"Interprate the observed spread with USERM","what":"üìö Citation","title":"Interprate Spread","text":"use package research, please cite paper package :","code":"Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker, Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation. (to be update)  Cai X (2025). _USERM: Unmixing Spread Estimation with Residual Model_. R package version   1.0.0,  <https://github.com/xiangmingcai/USERM>.    @Manual{,     title = {USERM: Unmixing Spread Estimation with Residual Model},     author = {Xiangming Cai},     year = {2025},     note = {R package version 1.0.0},     url = {https://github.com/xiangmingcai/USERM},   }"},{"path":"https://xiangmingcai.github.io/USERM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Xiangming Cai. Author, maintainer.","code":""},{"path":"https://xiangmingcai.github.io/USERM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cai X (2025). USERM: Unmixing Spread Estimation Residual Model. R package version 1.0.0, https://xiangmingcai.github.io/USERM.","code":"@Manual{,   title = {USERM: Unmixing Spread Estimation with Residual Model},   author = {Xiangming Cai},   year = {2025},   note = {R package version 1.0.0},   url = {https://xiangmingcai.github.io/USERM}, }"},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"userm-","dir":"","previous_headings":"","what":"Unmixing Spread Estimation with Residual Model","title":"Unmixing Spread Estimation with Residual Model","text":"Unmixing Spread Estimation based Residual Model","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-introduction","dir":"","previous_headings":"","what":"üîç Introduction","title":"Unmixing Spread Estimation with Residual Model","text":"USERM provides --box tool apply residual model approach [^1], characterizes predicts spread unmixed spectral flow cytometry data, arises instrumental noise deviations actual cellular emission average fluorescence signatures. USERM also supports computing various matrixes tools panel design, including Coef Matrix, Hotspot Matrix, Similarity Matrix, many others.","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-updates","dir":"","previous_headings":"","what":"üîß Updates","title":"Unmixing Spread Estimation with Residual Model","text":"2025-11-22: Release version 1.0.0","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-installation","dir":"","previous_headings":"","what":"üíª Installation","title":"Unmixing Spread Estimation with Residual Model","text":"can install development version USERM GitHub :","code":"devtools::install_github(\"xiangmingcai/USERM\")"},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-instruction","dir":"","previous_headings":"","what":"üñä Instruction","title":"Unmixing Spread Estimation with Residual Model","text":"following instructions reference can found : üìñ Documentation website basic use USERM instruction using custom single-color control FCS file instruction using USERM interpret observed spread","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_Ô∏è-contribute-single-cor-control-fcs-files-to-the-userm","dir":"","previous_headings":"","what":"‚öôÔ∏è Contribute Single-cor control FCS files to the USERM","title":"Unmixing Spread Estimation with Residual Model","text":"capabililty USERM greatly rely built-FCS. However, many fluorescence included current version. Also, many spectral flow cytometry instruments missing current USERM. current built-SCC human PBMC beads. means also short SCC acquired tissues species. great help contribute SCC USERM package. acknowledge contribution ‚ÄúResource‚Äù column querySig() return list. interested contributing SCC, please contact us directly via e-mail: Dr.¬†Juan J. Garcia Vallejo: jj.garciavallejo@amsterdamumc.nl Xiangming Cai: x.cai@amsterdamumc.nl xiangming_cai@126.com","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-feedback","dir":"","previous_headings":"","what":"üßÆ Feedback","title":"Unmixing Spread Estimation with Residual Model","text":"feedback welcomed! may post issue Issue USERM repository.","code":""},{"path":"https://xiangmingcai.github.io/USERM/index.html","id":"id_-citation","dir":"","previous_headings":"","what":"üìö Citation","title":"Unmixing Spread Estimation with Residual Model","text":"use package research, please cite paper package :","code":"Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker, Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation. (to be update)  Cai X (2025). _USERM: Unmixing Spread Estimation with Residual Model_. R package version   1.0.0,  <https://github.com/xiangmingcai/USERM>.  @Manual{,     title = {USERM: Unmixing Spread Estimation with Residual Model},     author = {Xiangming Cai},     year = {2025},     note = {R package version 1.0.0},     url = {https://github.com/xiangmingcai/USERM},   }"},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright ¬© 2007 Free Software Foundation, Inc.¬†<http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program‚Äìmake sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers‚Äô authors‚Äô protection, GPL clearly explains warranty free software. users‚Äô authors‚Äô sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users‚Äô freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"‚ÄúLicense‚Äù refers version 3 GNU General Public License. ‚ÄúCopyright‚Äù also means copyright-like laws apply kinds works, semiconductor masks. ‚ÄúProgram‚Äù refers copyrightable work licensed License. licensee addressed ‚Äú‚Äù. ‚ÄúLicensees‚Äù ‚Äúrecipients‚Äù may individuals organizations. ‚Äúmodify‚Äù work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called ‚Äúmodified version‚Äù earlier work work ‚Äúbased ‚Äù earlier work. ‚Äúcovered work‚Äù means either unmodified Program work based Program. ‚Äúpropagate‚Äù work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. ‚Äúconvey‚Äù work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays ‚ÄúAppropriate Legal Notices‚Äù extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"‚Äúsource code‚Äù work means preferred form work making modifications . ‚ÄúObject code‚Äù means non-source form work. ‚ÄúStandard Interface‚Äù means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. ‚ÄúSystem Libraries‚Äù executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. ‚ÄúMajor Component‚Äù, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . ‚ÄúCorresponding Source‚Äù work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work‚Äôs System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users‚Äô Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work‚Äôs users, third parties‚Äô legal rights forbid circumvention technological measures.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program‚Äôs source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 ‚Äúkeep intact notices‚Äù. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called ‚Äúaggregate‚Äù compilation resulting copyright used limit access legal rights compilation‚Äôs users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. ‚ÄúUser Product‚Äù either (1) ‚Äúconsumer product‚Äù, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, ‚Äúnormally used‚Äù refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. ‚ÄúInstallation Information‚Äù User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"‚ÄúAdditional permissions‚Äù terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered ‚Äúrestrictions‚Äù within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. ‚Äúentity transaction‚Äù transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party‚Äôs predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"‚Äúcontributor‚Äù copyright holder authorizes use License Program work Program based. work thus licensed called contributor‚Äôs ‚Äúcontributor version‚Äù. contributor‚Äôs ‚Äúessential patent claims‚Äù patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, ‚Äúcontrol‚Äù includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor‚Äôs essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, ‚Äúpatent license‚Äù express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). ‚Äúgrant‚Äù patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. ‚ÄúKnowingly relying‚Äù means actual knowledge , patent license, conveying covered work country, recipient‚Äôs use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license ‚Äúdiscriminatory‚Äù include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others‚Äô Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License ‚Äúlater version‚Äù applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy‚Äôs public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM ‚Äú‚Äù WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://xiangmingcai.github.io/USERM/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least ‚Äúcopyright‚Äù line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program‚Äôs commands might different; GUI interface, use ‚Äúbox‚Äù. also get employer (work programmer) school, , sign ‚Äúcopyright disclaimer‚Äù program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://xiangmingcai.github.io/USERM/reference/AddRes2Userm.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a Res object to a Userm object ‚Äî AddRes2Userm","title":"Add a Res object to a Userm object ‚Äî AddRes2Userm","text":"function validates adds Res object (Res) Userm object (Userm). checks whether Res object valid ID, matching detectors, properly structured matrices (interceptMtx slopMtx). checks pass, Res object added Userm$Res list.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddRes2Userm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a Res object to a Userm object ‚Äî AddRes2Userm","text":"","code":"AddRes2Userm(Res, Userm)"},{"path":"https://xiangmingcai.github.io/USERM/reference/AddRes2Userm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a Res object to a Userm object ‚Äî AddRes2Userm","text":"Res Res object. Userm Userm object, generated CreateUserm function.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddRes2Userm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a Res object to a Userm object ‚Äî AddRes2Userm","text":"updated Userm object new Res object added.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddRes2Userm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a Res object to a Userm object ‚Äî AddRes2Userm","text":"","code":"if (FALSE) { # \\dontrun{ Res <- CreateRes(id, R, A) Userm <- CreateUserm(A) Userm <- AddRes2Userm(Res, Userm) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/AddScale.html","id":null,"dir":"Reference","previous_headings":"","what":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","title":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","text":"function adds updates scaling parameters given fluorophore userm object. validates input fluor name, scaling method, numeric parameters, stores Scale_df field Userm object.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddScale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","text":"","code":"AddScale(Userm, fluor, min = -100, max = 1000, scale = \"Linear\", cofactor = 10)"},{"path":"https://xiangmingcai.github.io/USERM/reference/AddScale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","text":"Userm userm object created CreateUserm, containing fluor detector information. fluor character string specifying fluorophore update. min numeric value specifying minimum intensity threshold. Default -100. max numeric value specifying maximum intensity threshold. Default 1000. scale character string specifying scaling method. Must one \"Linear\", \"Log10\", \"Arcsinh\". Default \"Linear\". cofactor positive numeric value used scaling (used \"Arcsinh\"). Default 10.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddScale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","text":"updated Userm object new scaling parameters specified fluorophore.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/AddScale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add scaling parameters for a specific fluorophore ‚Äî AddScale","text":"","code":"if (FALSE) { # \\dontrun{ A <- matrix(runif(20), nrow = 4, ncol = 5) rownames(A) <- paste0(\"D\", 1:4) colnames(A) <- paste0(\"F\", 1:5) Userm <- CreateUserm(A) Userm <- AddScale(Userm, fluor = \"F1\", min = 0, max = 5000, scale = \"Arcsinh\", cofactor = 5) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","title":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","text":"function generates heatmap covariance matrix specified bin index result object Res. heatmap uses customizable color gradient overlays numeric values cell.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","text":"","code":"checkRes_covMtx(   Res,   bin = 1,   min = -1,   mid = 0,   max = 1,   mincolor = \"blue\",   midcolor = \"white\",   maxcolor = \"red\" )"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","text":"Res Res object containing following components: cov_matrices: 3D array covariance matrices (detector x detector x bin). detectors: character vector detector names. bin_mids: numeric vector bin midpoints. id: identifier result object, used plot title. bin Integer index specifying bin's covariance matrix visualize. Default 1 (first bin). min Minimum value color scale. Default -1. mid Midpoint value color scale. Default 0. max Maximum value color scale. Default 1. mincolor Color corresponding minimum value. Default \"blue\". midcolor Color corresponding midpoint value. Default \"white\". maxcolor Color corresponding maximum value. Default \"red\".","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","text":"Heatmap object ComplexHeatmap package, visualizing covariance matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize Covariance Matrix at a Specific Bin ‚Äî checkRes_covMtx","text":"","code":"if (FALSE) { # \\dontrun{   checkRes_covMtx(Res, bin = 2) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covScatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","title":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","text":"function generates scatter plot covariance values two specified detectors across bin midpoints, using data result object Res. regression line added using corresponding slope intercept values, also displayed plot title.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covScatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","text":"","code":"checkRes_covScatter(Res, detector1, detector2)"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covScatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","text":"Res list containing following components: bin_mids: numeric vector bin midpoints. detectors: character vector detector names. cov_matrices: 3D array covariance values indexed detector pairs bins. slopMtx: matrix slope values detector pair. interceptMtx: matrix intercept values detector pair. detector1 Name one detector (character string). detector2 Name another detector (character string).","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covScatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","text":"ggplot object showing scatter plot covariance values regression line.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_covScatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Covariance Scatter Between Two Detectors with Regression Line ‚Äî checkRes_covScatter","text":"","code":"if (FALSE) { # \\dontrun{ checkRes_covScatter(Res = ResObj, detector1 = ResObj$detectors[1], detector2 = ResObj$detectors[2]) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_interceptMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","title":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","text":"function creates heatmap visualization interceptMtx matrix contained within result object Res. uses customizable color gradient overlays numeric values cell.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_interceptMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","text":"","code":"checkRes_interceptMtx(   Res,   min = -10,   mid = 0,   max = 10,   mincolor = \"blue\",   midcolor = \"white\",   maxcolor = \"red\" )"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_interceptMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","text":"Res Res object. min Numeric value representing minimum color scale. Default -10. mid Numeric value representing midpoint color scale. Default 0. max Numeric value representing maximum color scale. Default 10. mincolor Color corresponding minimum value. Default \"blue\". midcolor Color corresponding midpoint value. Default \"white\". maxcolor Color corresponding maximum value. Default \"red\".","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_interceptMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","text":"Heatmap object ComplexHeatmap package, visualizing interceptMtx annotated values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_interceptMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize the Intercept Matrix from a Result Object ‚Äî checkRes_interceptMtx","text":"","code":"if (FALSE) { # \\dontrun{   checkRes_interceptMtx(result) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_slopMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","title":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","text":"function generates heatmap visualization slopMtx matrix contained within result object Res. uses customizable color gradient overlays numeric values cell.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_slopMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","text":"","code":"checkRes_slopMtx(   Res,   min = -1,   mid = 0,   max = 1,   mincolor = \"blue\",   midcolor = \"white\",   maxcolor = \"red\" )"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_slopMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","text":"Res Res object. min Numeric value representing minimum color scale. Default -1. mid Numeric value representing midpoint color scale. Default 0. max Numeric value representing maximum color scale. Default 1. mincolor Color corresponding minimum value. Default \"blue\". midcolor Color corresponding midpoint value. Default \"white\". maxcolor Color corresponding maximum value. Default \"red\".","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_slopMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","text":"Heatmap object ComplexHeatmap package, visualizing slopMtx annotated values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkRes_slopMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize the Slope Matrix from a Result Object ‚Äî checkRes_slopMtx","text":"","code":"if (FALSE) { # \\dontrun{   checkRes_slopMtx(Res) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"function generates line plot signal signature specified ID using precomputed data stored package. plot shows normalized signal values across detectors, line point markers.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"","code":"checkSig_linePlot(id, Sig_list = NULL)"},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"id character string specifying ID visualized. Must exist querySig() return.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"ggplot object showing signal signature line plot given ID.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"function reads Sig_list.rds file sig directory USERM package. specified ID found list, error raised. plot includes title based ID displays signal values across detectors.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/checkSig_linePlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Signature Signal Line for a Given ID ‚Äî checkSig_linePlot","text":"","code":"if (FALSE) { # \\dontrun{   checkSig_linePlot(\"SCC_Bead_CD4_NFR700\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"function calculates spillover spreading score (SS) primary fluorophore (f_pos) secondary fluorophore (f_neg) using precomputed SSM objects unmixing matrix . supports built-custom SSM sources, performs detector--fluorophore unmixing followed quantile-based spread estimation.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"","code":"check_ss(f_pos, f_neg, SSM_fluor, A, Userm, custom_ssm_dir = NULL)"},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"f_pos character string specifying positive fluorophore (positive channel). f_neg character string specifying negative fluorophore (negative channel). SSM_fluor character vector fluorophores required SSM computation. Used availability checks. numeric matrix representing detector--fluorophore unmixing matrix. Row names must detector names; column names must fluorophore names. custom_ssm_dir Optional path directory containing custom SSM .rds files. Default NULL.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"list containing: f_pos positive fluorophore name. f_neg negative fluorophore name. B_pos Unmixed positive sample matrix (cells √ó fluorophores). B_neg Unmixed negative sample matrix (cells √ó fluorophores). R_F_neg_84 84th percentile f_neg negative samples. R_F_neg_50 Median f_neg negative samples. R_sigma_F_neg Spread f_neg negative samples. S_F_neg_84 84th percentile f_neg positive samples. S_F_neg_50 Median f_neg positive samples. S_sigma_F_neg Spread f_neg positive samples. S_F_pos_50 Median f_pos positive samples. R_F_pos_50 Median f_pos negative samples. delta_F_pos Difference median signal f_pos positive negative samples. delta_sigma_F_neg_2 Difference squared spread f_neg positive negative samples. ss_2 Intermediate SS score square root transformation. ss Final spillover spreading score.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"detailed explanation returned items, please refer Fig1A Nguyen, Perfetto et al. Quantifying Spillover Spreading Comparing Instrument Performance Aiding Multicolor Panel Design‚Äù. Cytometry . 2013. function loads SSM objects specified fluorophores, checks detector compatibility unmixing matrix, performs matrix inversion unmixing, computes quantile-based spread metrics. SS score derived change spread negative channel (f_neg) relative signal increase positive channel (f_pos). f_pos == f_neg, score set zero intermediate metrics returned NA.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/check_ss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Spillover Spreading Score (SS) Between Fluorophores ‚Äî check_ss","text":"","code":"if (FALSE) { # \\dontrun{ A <- matrix(runif(25), nrow = 5) rownames(A) <- paste0(\"Det\", 1:5) colnames(A) <- c(\"FITC\", \"PE\", \"APC\", \"PerCP\", \"BV421\") check_ss(f_pos = \"FITC\", f_neg = \"PE\", SSM_fluor = c(\"FITC\", \"PE\"),          A = A, custom_ssm_dir = \"~/custom_ssm\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/correct_to_horizontal.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","title":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","text":"function performs linear regression Y X removes fitted trend Y, effectively flattening horizontal baseline preserving residual variation. corrected values returned new column Y_corrected input data frame.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/correct_to_horizontal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","text":"","code":"correct_to_horizontal(df)"},{"path":"https://xiangmingcai.github.io/USERM/reference/correct_to_horizontal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","text":"df data frame containing two numeric columns: X Y.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/correct_to_horizontal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","text":"data frame identical df, additional column Y_corrected representing detrended version Y, centered around original mean.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/correct_to_horizontal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove linear trend from Y relative to X ‚Äî correct_to_horizontal","text":"","code":"set.seed(123) df <- data.frame(   X = 1:100,   Y = 0.5 * (1:100) + rnorm(100, sd = 5) ) df_corrected <- correct_to_horizontal(df) plot(df$X, df$Y, type = \"l\", col = \"blue\") lines(df$X, df_corrected$Y_corrected, col = \"red\")"},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateRes.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Res object ‚Äî CreateRes","title":"Create a Res object ‚Äî CreateRes","text":"function creates structured result object (Res) storing residual model information extracted spectral flow scc file. validates input raw signal matrix R unmixing matrix , ensuring dimensions identifiers compatible. valid, returns list containing initialized fields analysis.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateRes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Res object ‚Äî CreateRes","text":"","code":"CreateRes(id, R, A_Target, A_AF)"},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateRes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Res object ‚Äî CreateRes","text":"id character string representing identifier result object. missing, defaults \"x\". R numeric matrix raw signal data (cells √ó detectors), typically extracted FCS file. numeric unmixing matrix (detectors √ó fluors), typically extracted single-stained control (SCC) FCS file.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateRes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Res object ‚Äî CreateRes","text":"named list representing initialized residual modeling object (Res) following components: id Character string identifier residual object. Defaults \"x\" provided. R Numeric matrix raw signal data (cells √ó detectors), subset match 's rownames. Numeric unmixing matrix (detectors √ó fluors), validated row column names. one fluorescence, signature . detectors Character vector detector names, extracted rownames(). fluors Character vector fluor names, extracted colnames() auto-assigned. par List analysis parameters, including: bin_num Number bins used residual modeling (default NA). bin_method Binning method used (e.g., \"equal-width\", \"quantile\"; default NA). count_thre Threshold minimum bin count (default NA). bin_mids Numeric vector bin midpoints (default NA). bin_counts Numeric vector bin counts (default NA). cov_matrices List covariance matrices per bin (default NA). interceptMtx Matrix intercepts bin-wise regression (default NA). slopMtx Matrix slopes bin-wise regression (default NA). CreateRes function used together SlopEstimation function fill contents ResObj. See SlopEstimation detail.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateRes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Res object ‚Äî CreateRes","text":"","code":"if (FALSE) { # \\dontrun{ R <- matrix(runif(100), nrow = 10, ncol = 5) colnames(R) <- paste0(\"D\", 1:5) A <- matrix(runif(25), nrow = 5, ncol = 5) rownames(A) <- paste0(\"D\", 1:5) colnames(A) <- paste0(\"F\", 1:5) Res <- CreateRes(\"Sample1\", R, A) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateUserm.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a userm object ‚Äî CreateUserm","title":"Create a userm object ‚Äî CreateUserm","text":"function initializes userm object (Userm) based unmixing matrix . validates structure , assigns default fluor names missing, prepares placeholders storing results, scaling parameters, intensity values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateUserm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a userm object ‚Äî CreateUserm","text":"","code":"CreateUserm(A)"},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateUserm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a userm object ‚Äî CreateUserm","text":"numeric unmixing matrix (detectors √ó fluors), typically extracted single-stained control (SCC) FCS file. Row names represent detector channels, column names represent fluorophores.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateUserm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a userm object ‚Äî CreateUserm","text":"list representing userm object, containing: : input unmixing matrix. detectors: vector detector names. fluors: vector fluorophore names. Res: named list store res objects fluor. Scale_df: data frame storing scaling parameters (min, max, scale, cofactor). Intensity_mtx: data frame storing default intensity values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/CreateUserm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a userm object ‚Äî CreateUserm","text":"","code":"if (FALSE) { # \\dontrun{ A <- matrix(runif(20), nrow = 4, ncol = 5) rownames(A) <- paste0(\"D\", 1:4) colnames(A) <- paste0(\"F\", 1:5) Userm <- CreateUserm(A) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/create_seq.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","title":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","text":"function generates numeric sequence minimum maximum value using one three scaling methods: \"Linear\", \"Log10\", \"Arcsinh\". supports signed transformations logarithmic arcsinh scaling.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/create_seq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","text":"","code":"create_seq(min, max, len, scale, cofactor)"},{"path":"https://xiangmingcai.github.io/USERM/reference/create_seq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","text":"min numeric value specifying start sequence. max numeric value specifying end sequence. len integer specifying number points sequence. scale character string specifying scaling method. Must one \"Linear\", \"Log10\", \"Arcsinh\". cofactor numeric value used \"Arcsinh\" transformation. Ignored scaling methods.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/create_seq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","text":"numeric vector length len representing scaled sequence.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/create_seq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a numeric sequence based on a scaling method ‚Äî create_seq","text":"","code":"create_seq(min = 0, max = 1000, len = 50, scale = \"Linear\", cofactor = 5) #>  [1]    0.00000   20.40816   40.81633   61.22449   81.63265  102.04082 #>  [7]  122.44898  142.85714  163.26531  183.67347  204.08163  224.48980 #> [13]  244.89796  265.30612  285.71429  306.12245  326.53061  346.93878 #> [19]  367.34694  387.75510  408.16327  428.57143  448.97959  469.38776 #> [25]  489.79592  510.20408  530.61224  551.02041  571.42857  591.83673 #> [31]  612.24490  632.65306  653.06122  673.46939  693.87755  714.28571 #> [37]  734.69388  755.10204  775.51020  795.91837  816.32653  836.73469 #> [43]  857.14286  877.55102  897.95918  918.36735  938.77551  959.18367 #> [49]  979.59184 1000.00000 create_seq(min = -100, max = 1000, len = 50, scale = \"Log10\", cofactor = 5) #>  [1] -100.0000000  -78.8331944  -62.1023657  -48.8778557  -38.4248372 #>  [6]  -30.1624821  -23.6316880  -18.4695677  -14.3892850  -11.1641167 #> [11]   -8.6148544   -6.5998469   -5.0071293   -3.7482012   -2.7531096 #> [16]   -1.9665617   -1.3448524   -0.8534362   -0.4650073   -0.1579823 #> [21]    0.0925365    0.3822093    0.7486854    1.2123282    1.7989002 #> [26]    2.5409948    3.4798467    4.6676238    6.1703257    8.0714508 #> [31]   10.4766362   13.5195275   17.3692045   22.2395768   28.4012694 #> [36]   36.1966603   46.0589047   58.5360039   74.3212550   94.2917744 #> [41]  119.5572354  151.5215277  191.9607653  243.1219775  307.8479661 #> [46]  389.7352675  493.3339959  624.4006737  790.2180954 1000.0000000 create_seq(min = -100, max = 1000, len = 50, scale = \"Arcsinh\", cofactor = 5) #>  [1] -100.0000000  -82.0473522  -67.3077938  -55.2041030  -45.2622824 #>  [6]  -37.0929963  -30.3763240  -24.8492311  -20.2952690  -16.5360981 #> [11]  -13.4245041  -10.8386324   -8.6772168   -6.8556132   -5.3024850 #> [16]   -3.9570096   -2.7664962   -1.6843227   -0.6681097    0.3219393 #> [21]    1.3245958    2.3791254    3.5268249    4.8126397    6.2869243 #> [26]    8.0074137   10.0414847   12.4687942   15.3843993   18.9024790 #> [31]   23.1608063   28.3261433   34.6007718   42.2304151   51.5138607 #> [36]   62.8146614   76.5753723   93.3348823  113.7495173  138.6187429 #> [41]  168.9164731  205.8292093  250.8025063  305.5975813  372.3602864 #> [46]  453.7051428  552.8177293  673.5794338  820.7194542 1000.0000000"},{"path":"https://xiangmingcai.github.io/USERM/reference/EllipseLine_intersection.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","title":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","text":"function calculates intersection points ellipse straight line passes center ellipse given slope. handles regular slopes vertical lines (slope = Inf).","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EllipseLine_intersection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","text":"","code":"EllipseLine_intersection(center, radius, lineslop)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EllipseLine_intersection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","text":"center numeric vector length 2 specifying center ellipse (h, k). radius numeric vector length 2 specifying semi-axes ellipse (, b). lineslop numeric value specifying slope m line. Use Inf vertical lines.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EllipseLine_intersection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","text":"2x2 matrix row names \"p1\" \"p2\", column names \"x\" \"y\", representing coordinates two intersection points.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EllipseLine_intersection.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Intersection Points Between an Ellipse and a Line ‚Äî EllipseLine_intersection","text":"","code":"if (FALSE) { # \\dontrun{   # Regular slope   EllipseLine_intersection(center = c(0, 0), radius = c(3, 2), lineslop = 1)    # Vertical line   EllipseLine_intersection(center = c(0, 0), radius = c(3, 2), lineslop = Inf) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"function computes tangent matrix representing diagonalized slope components signal spread across fluorochromes, based system matrix slope matrices USERM result object.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"","code":"EstimateCoefMtx(Userm)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"Userm list containing USERM analysis results. Must include: detectors: character vector detector names. fluors: character vector fluorochrome names. : system matrix mapping detectors fluorochromes. Res: named list result objects fluorochrome, containing slopMtx.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"square numeric matrix fluorochrome names row column names. entry represents diagonalized slope component projected pseudo-inverse system matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"function uses pseudo-inverse system matrix transform slope matrices detector space fluorochrome space. diagonal elements transformed matrices extracted assembled final tangent matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateCoefMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Coefficient Matrix of Slope Components in USERM ‚Äî EstimateCoefMtx","text":"","code":"if (FALSE) { # \\dontrun{   tangent_mtx <- EstimateCoefMtx(Userm)   print(tangent_mtx) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"function computes distance matrix fluorochrome pairs based geometric relationship signal ellipses two USERM spread objects (Spr). distance defined ratio center--center distance sum ellipse radii along connecting line. value less 1 indicates overlapping ellipses.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"","code":"EstimateDistance(Spr1, Spr2)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"Spr1 spread object generated EstimateSpread(), containing intensity variance information population. Spr2 Another spread object generated EstimateSpread(), compared Spr1.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"square numeric matrix fluorochrome names row column names. entry represents elliptical distance ratio pair fluorochromes Spr1 Spr2.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"function checks spread objects contain set fluorochromes. fluorochrome pair, calculates: center positions intensity values. ellipse radii square root summed intercept slope variances. distance ellipse centers. sum half-lengths line segments within ellipse along connecting direction. final distance ratio computed : $$(distance\\_between\\_centers + 0.01) / (sum\\_of\\_ellipse\\_radii + 0.01)$$","code":""},{"path":[]},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateDistance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Elliptical Distance Between Two USERM Spread Objects ‚Äî EstimateDistance","text":"","code":"if (FALSE) { # \\dontrun{   dist_matrix <- EstimateDistance(Spr1, Spr2)   heatmap(dist_matrix) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateHotspotMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","title":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","text":"Computes hotspot matrix based user-defined matrix , using specified detectors fluorophores. function extracts submatrix , calculates Gram matrix, applies Moore-Penrose pseudoinverse, returns square root absolute values result.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateHotspotMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","text":"","code":"EstimateHotspotMtx(A)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateHotspotMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","text":"numeric matrix named rows columns representing detectors fluorophores.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateHotspotMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","text":"numeric matrix representing estimated hotspot matrix, derived pseudoinverse Gram matrix selected submatrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateHotspotMtx.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Hotspot Matrix ‚Äî EstimateHotspotMtx","text":"function performs following steps: Computes Gram matrix: t() %*% . Applies Moore-Penrose pseudoinverse Gram matrix. Takes square root absolute values pseudoinverse matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSimilarityMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","title":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","text":"function computes pairwise cosine similarity fluorochrome spectral profiles based user-defined matrix detector responses. extracts submatrix full spectral matrix using specified detectors fluorochromes, returns symmetric similarity matrix entry represents cosine similarity two fluorochromes.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSimilarityMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","text":"","code":"EstimateSimilarityMtx(A)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSimilarityMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","text":"numeric matrix named rows columns representing detectors fluorophores.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSimilarityMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","text":"symmetric numeric matrix cosine similarity values fluorochromes. matrix fluorochrome names row column names.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSimilarityMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Cosine Similarity Matrix for Fluorochromes ‚Äî EstimateSimilarityMtx","text":"","code":"if (FALSE) { # \\dontrun{ EstimateSimilarityMtx(Userm) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSpread.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","title":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","text":"function estimates signal spread (variance components) specified population using USERM result object. computes weighted intercept slope variances across detectors fluorochromes based system matrix signal intensities.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSpread.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","text":"","code":"EstimateSpread(Userm, population_id)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSpread.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","text":"Userm list containing USERM analysis results. Must include: Intensity_mtx: matrix signal intensities (fluorochrome x population). detectors: character vector detector names. fluors: character vector fluorochrome names. : system matrix mapping detectors fluorochromes. Res: named list result objects fluorochrome, containing interceptMtx slopMtx. population_id character string specifying population ID estimate spread . Must match column name Userm$Intensity_mtx.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSpread.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","text":"list containing: population_id: input population ID. : system matrix used. fluors: Fluorochrome names. detectors: Detector names. intensity_matrix: Signal intensity values specified population. intercept_sigma2_col: Estimated intercept variance per channel. slop_sigma2_col: Estimated slope variance per channel.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSpread.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Signal Spread for a Given Population ‚Äî EstimateSpread","text":"","code":"if (FALSE) { # \\dontrun{   EstimateSpread(Userm, \"Population_1\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"Computes full Spillover Spreading Matrix (SSM) set fluorophores using precomputed positive/negative control data unmixing matrix. matrix quantifies extent signal spreading fluorophore others, aiding panel design instrument evaluation spectral flow cytometry.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"","code":"EstimateSSM(SSM_fluor, A, Userm, custom_ssm_dir = NULL, quiet = FALSE)"},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"SSM_fluor character vector fluorophore names include SSM. must corresponding SSMObj_*.rds file. numeric unmixing matrix (detectors √ó fluorophores) row names detector channels column names fluorophores. custom_ssm_dir Optional path directory containing custom SSMObj_*.rds files. NULL, built-files USERM package used.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"numeric matrix spillover spreading scores, rows columns named SSM_fluor. entry ssm[, j] represents spreading fluorophore fluorophore j. Diagonal entries set 0.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"fluorophore SSM_fluor, function loads corresponding SSM object containing positive negative control data. performs detector--fluorophore unmixing using pseudoinverse matrix , calculates quantile-based spread metrics fluorophore pair. spillover spreading score computed : $$SS = \\sqrt{(S_{\\sigma}^2 - R_{\\sigma}^2) / \\Delta F}$$ \\(S_{\\sigma}\\) \\(R_{\\sigma}\\) 84th‚Äì50th percentile spreads positive negative samples, \\(\\Delta F\\) median signal increase primary fluorophore. \\(\\Delta F = 0\\), score set NA. Negative intermediate values yield imaginary scores, returned negative square roots.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/EstimateSSM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Spillover Spreading Matrix (SSM) from Unmixing and Control Data ‚Äî EstimateSSM","text":"","code":"if (FALSE) { # \\dontrun{ A <- matrix(runif(25), nrow = 5) rownames(A) <- paste0(\"Det\", 1:5) colnames(A) <- c(\"FITC\", \"PE\", \"APC\", \"PerCP\", \"BV421\") EstimateSSM(SSM_fluor = c(\"FITC\", \"PE\", \"APC\"), A = A, custom_ssm_dir = \"~/custom_ssm\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSig.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","title":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","text":"function computes normalized signature vector comparing positive negative control data set specified detector channels. applies summary method (e.g., median, mean) column positive negative data frames, calculates difference, normalizes result.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","text":"","code":"ExtractSig(   df_pos,   df_neg,   cols,   method,   PrimaryName,   SecondaryName,   id,   instrument,   Source,   Note = NA )"},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","text":"df_pos data frame containing positive control signal data (cells x detectors). df_neg data frame containing negative control signal data (cells x detectors). cols character vector specifying column names (detector channels) used signature extraction. method function used summarize column (e.g., median, mean). PrimaryName character string specifying primary name fluorophore. SecondaryName character string specifying secondary name fluorophore marker. id character string used identify signature object. instrument character string used specify instrument used generate raw data, e.g. Aurora5L, Xenith. Source character string used specify source raw data, e.g. name researcher institution. Note character string used specify additional information related fluorophore.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","text":"list containing: id identifier string. PrimaryName primary name fluorophore. SecondaryName secondary name fluorophore marker. Signature normalized numeric vector representing extracted signature.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract a normalized signature from a single-stained control (SCC) ‚Äî ExtractSig","text":"","code":"if (FALSE) { # \\dontrun{ df_pos <- data.frame(D1 = rnorm(100, 100), D2 = rnorm(100, 200)) df_neg <- data.frame(D1 = rnorm(100, 10), D2 = rnorm(100, 20)) sig <- ExtractSig(df_pos, df_neg, cols = c(\"D1\", \"D2\"), method = mean,                   PrimaryName = \"FITC\", SecondaryName = \"CD3\", id = \"FITC_CD3\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"Computes Spillover Spreading Matrix (SSM) related object applying user-defined summary method selected signal channels positive negative control datasets.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"","code":"ExtractSSM(   df_pos,   df_neg,   cols,   method,   PrimaryName,   SecondaryName,   id,   instrument,   Source,   Note = NA )"},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"df_pos data frame containing positive control samples (e.g., single-stained beads). df_neg data frame containing negative control samples (e.g., unstained background). cols character vector specifying signal channels (column names) include SSM calculation. method summary function (e.g., mean, median) applied channel. Must accept na.rm = TRUE. PrimaryName character string specifying primary name fluorophore. SecondaryName character string specifying secondary name fluorophore marker. id unique identifier SSM signature. instrument character string describing cytometry instrument used. Source character string indicating source origin dataset. Note Optional notes annotations. Default NA.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"list containing: id provided identifier. PrimaryName Label primary condition. SecondaryName Label secondary condition. Signature numeric vector normalized spreading scores across channels. instrument Instrument description. Source Data source. Note Optional notes. df_pos Sampled positive control data (max 1000 rows). df_neg Sampled negative control data (max 1000 rows).","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"Spillover Spreading Matrix (SSM) quantifies extent signal spreading one channel others, critical panel design instrument performance evaluation spectral flow cytometry. Input data frames subsetted specified channels randomly sampled (1000 rows) reduce output size facilitate downstream visualization.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/ExtractSSM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Spillover Spreading Matrix (SSM) related object from Positive and Negative Controls ‚Äî ExtractSSM","text":"","code":"if (FALSE) { # \\dontrun{ pos <- data.frame(CD3 = rnorm(2000), CD19 = rnorm(2000)) neg <- data.frame(CD3 = rnorm(2000), CD19 = rnorm(2000)) ExtractSSM(df_pos = pos, df_neg = neg, cols = c(\"CD3\", \"CD19\"),            method = median, PrimaryName = \"FITC\", SecondaryName = \"CD3\",            id = \"FITC_CD3\", instrument = \"Aurora\", Source = \"PanelX\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/getColor.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate a color based on a numeric value ‚Äî getColor","title":"Interpolate a color based on a numeric value ‚Äî getColor","text":"function interpolates color three specified colors (minimum, midpoint, maximum) based position numeric value within defined range.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getColor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate a color based on a numeric value ‚Äî getColor","text":"","code":"getColor(val, min, mid, max, colormin, colormid, colormax)"},{"path":"https://xiangmingcai.github.io/USERM/reference/getColor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate a color based on a numeric value ‚Äî getColor","text":"val numeric value mapped color. min minimum value range. mid midpoint value range. max maximum value range. colormin color (HEX format) corresponding minimum value. colormid color (HEX format) corresponding midpoint value. colormax color (HEX format) corresponding maximum value.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getColor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate a color based on a numeric value ‚Äî getColor","text":"HEX color string representing interpolated color.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getColor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate a color based on a numeric value ‚Äî getColor","text":"","code":"getColor(0.75, 0, 0.5, 1, \"#0000FF\", \"#00FF00\", \"#FF0000\") #> [1] \"#808000\""},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve Result Object by ID ‚Äî getRes","title":"Retrieve Result Object by ID ‚Äî getRes","text":"function loads serialized result object internal package directory based given ID. result object expected stored RDS file named ResObj_<id>.rds within res folder USERM package.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve Result Object by ID ‚Äî getRes","text":"","code":"getRes(id, custom_dir = NULL)"},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve Result Object by ID ‚Äî getRes","text":"id character string representing ID result object retrieve.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve Result Object by ID ‚Äî getRes","text":"R object containing result data associated specified ID.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve Result Object by ID ‚Äî getRes","text":"function constructs file path using system.file() checks whether corresponding RDS file exists. file found, read returned. , function throws error indicating result object found.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getRes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve Result Object by ID ‚Äî getRes","text":"","code":"if (FALSE) { # \\dontrun{   res <- getRes(\"SCC_Bead_CD4_NFR700\")   print(res) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"function extracts subset Signature objects internal Signature database based vector provided IDs. validates presence ID, checks consistency detector names across selected Signatures, returns matrix Signature values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"","code":"getSigMtx(ids, Sig_list = NULL)"},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"ids character vector Signature IDs retrieve. Sig_list Users may provide Signature list , contains signature items generated ExtractSig function.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"numeric matrix Signature values detectors consistent across selected Signatures. Otherwise, function returns list Signature objects.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"function reads Signature list internal package path: system.file(\"sig\", \"Sig_list.rds\", package = \"USERM\"). searches ID Signature list throws error ID found. selected Signatures share set detectors, numeric matrix returned rows represent detectors columns represent Signature IDs. detector sets differ, warning issued original Signature list returned instead.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/getSigMtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve Signature Matrix by ID ‚Äî getSigMtx","text":"","code":"if (FALSE) { # \\dontrun{   ids <- c(\"SCC_Bead_CD4_NFR700\", \"SCC_Bead_CD3_BV510\",  \"SCC_Bead_CD2_FITC\")   sig_matrix <- getSigMtx(ids)   print(sig_matrix) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","title":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","text":"function creates ggplot-based visualization predicted unmixed spread using either pseudo-color isobands contour lines. supports multiple axis scaling methods (Linear, Log10, Arcsinh), optionally overlays population labels based intensity matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","text":"","code":"PredIsobandPlot(   grid,   x_scale,   y_scale,   x_cofactor,   y_cofactor,   x_label,   y_label,   x_min,   x_max,   y_min,   y_max,   mode,   legend_show = TRUE,   label_population = NA,   intensity_matrix = NA )"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","text":"grid data frame containing columns x, y, z, representing grid coordinates predicted values. x_scale character string specifying x-axis scale. Must one \"Linear\", \"Log10\", \"Arcsinh\". y_scale character string specifying y-axis scale. Must one \"Linear\", \"Log10\", \"Arcsinh\". x_cofactor numeric value used Arcsinh transformation x-axis. Ignored scales. y_cofactor numeric value used Arcsinh transformation y-axis. Ignored scales. x_label character string x-axis label. y_label character string y-axis label. x_min Minimum value x-axis. x_max Maximum value x-axis. y_min Minimum value y-axis. y_max Maximum value y-axis. mode character string specifying plot mode. Must either \"Pseudo-color\" \"Contour line\". label_population Optional character vector specifying population names label plot. intensity_matrix Optional matrix data frame containing intensity values labeling populations. Must include rows named x_label y_label. legned_show Logical; whether show legend. Default TRUE.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","text":"ggplot object representing prediction plot.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a prediction plot of unmixed spread using isobands or contour lines ‚Äî PredIsobandPlot","text":"","code":"if (FALSE) { # \\dontrun{ grid <- expand.grid(x = seq(0, 1000, length.out = 50),                     y = seq(0, 1000, length.out = 50)) grid$z <- with(grid, exp(-((x - 500)^2 + (y - 500)^2) / 1e5)) PredIsobandPlot(grid, x_scale = \"Linear\", y_scale = \"Linear\",                 x_cofactor = 5, y_cofactor = 5,                 x_label = \"X\", y_label = \"Y\",                 x_min = 0, x_max = 1000,                 y_min = 0, y_max = 1000,                 mode = \"Pseudo-color\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlotMulti.html","id":null,"dir":"Reference","previous_headings":"","what":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","title":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","text":"function creates ggplot-based visualization overlays multiple prediction grids single plot. grid represents model's prediction distinguished color. function supports various axis scaling methods (Linear, Log10, Arcsinh), optionally overlays population labels based intensity matrix.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlotMulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","text":"","code":"PredIsobandPlotMulti(   grid_list,   x_label = \"X\",   y_label = \"Y\",   x_scale = \"Linear\",   y_scale = \"Linear\",   x_cofactor = 5,   y_cofactor = 5,   x_min = NULL,   x_max = NULL,   y_min = NULL,   y_max = NULL,   mode = \"Pseudo-color\",   legend_show = TRUE,   label_population = NA,   intensity_matrix = NA )"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlotMulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","text":"grid_list named list data frames, containing columns x, y, z. data frame represents prediction grid model. x_label character string x-axis label. y_label character string y-axis label. x_scale character string specifying x-axis scale. Must one \"Linear\", \"Log10\", \"Arcsinh\". y_scale character string specifying y-axis scale. Must one \"Linear\", \"Log10\", \"Arcsinh\". x_cofactor numeric value used Arcsinh transformation x-axis. Ignored scales. y_cofactor numeric value used Arcsinh transformation y-axis. Ignored scales. x_min Minimum value x-axis. x_max Maximum value x-axis. y_min Minimum value y-axis. y_max Maximum value y-axis. mode character string specifying plot mode. Must either \"Contour line\" \"Pseudo-color\". legend_show Logical; whether show legend. Default TRUE. label_population Optional character vector specifying population names label plot. intensity_matrix Optional matrix data frame containing intensity values labeling populations. Must include rows named x_label y_label.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlotMulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","text":"ggplot object representing combined prediction plot.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredIsobandPlotMulti.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Overlay Prediction Grids Using Isobands or Contour Lines ‚Äî PredIsobandPlotMulti","text":"","code":"if (FALSE) { # \\dontrun{ PredIsobandPlotMulti(grid_list,                      x_label = \"X\", y_label = \"Y\",                      x_scale = \"Linear\", y_scale = \"Linear\",                      x_min = 0, x_max = 1000,                      y_min = 0, y_max = 1000,                      mode = \"Pseudo-color\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"function launches Shiny application allows users interactively explore predicted spread unmixed signals multiple populations based given userm object (Userm). app provides multiple tabs visualizing unmixing matrix, prediction plots, slope intercept matrices, exporting results.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"","code":"PredMultipleSpread(Userm, population_ids)"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"Userm userm object created CreateUserm, containing unmixing matrix, detector fluor information, intensity data. population_ids character vector specifying one column names Userm$Intensity_mtx representing populations visualized.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"Shiny UI object can passed shinyApp() used within Shiny server function.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"app includes following features: Fluor detector selection panels Interactive prediction plot scale axis controls Visualization unmixing, pseudoinverse, slope, intercept matrices Export options HTML reports NxN/Nx1 plots","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredMultipleSpread.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch an interactive Shiny app to explore predicted spread for multiple populations ‚Äî PredMultipleSpread","text":"","code":"if (FALSE) { # \\dontrun{ PredMultipleSpread(Userm, population_ids = c(\"P1\", \"P2\")) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"function launches Shiny application allows users interactively explore predicted spread unmixed signals based given userm object (Userm) selected population. app provides multiple tabs visualizing unmixing matrix, prediction plots, slope intercept matrices, exporting results.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"","code":"PredOneSpread(Userm, population_id)"},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"Userm userm object created CreateUserm, containing unmixing matrix, detector fluor information, intensity data. population_id character string specifying column name Userm$Intensity_mtx representing population visualized.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"Shiny UI object can passed shinyApp() used within Shiny server function.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"app includes following features: Fluor detector selection panels Interactive prediction plot scale axis controls Visualization unmixing, pseudoinverse, slope, intercept matrices Export options HTML reports NxN/Nx1 plots","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/PredOneSpread.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch an interactive Shiny app to explore predicted spread ‚Äî PredOneSpread","text":"","code":"if (FALSE) { # \\dontrun{ PredOneSpread(Userm, population_id = \"P1\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/querySig.html","id":null,"dir":"Reference","previous_headings":"","what":"Query and summarize Signature list information ‚Äî querySig","title":"Query and summarize Signature list information ‚Äî querySig","text":"function reads serialized RDS file containing list Signature objects, extracts key metadata Signature, returns structured data frame.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/querySig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query and summarize Signature list information ‚Äî querySig","text":"","code":"querySig(Sig_list = NULL)"},{"path":"https://xiangmingcai.github.io/USERM/reference/querySig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query and summarize Signature list information ‚Äî querySig","text":"data.frame following columns: id Unique identifier Signature PrimaryName Primary name Signature SecondaryName Secondary name Signature detectors Number detectors Signature instrument Instrument associated Signature","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/querySig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query and summarize Signature list information ‚Äî querySig","text":"","code":"if (FALSE) { # \\dontrun{   sig_info <- querySig()   head(sig_info) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"function renames fluorophore across relevant components Userm object, including fluors, matrices, data frames, result lists. ensures consistency naming throughout object updates Rename_table accordingly.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"","code":"RenameFluor(Userm, raw_name, new_name)"},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"Userm Userm object containing fluorophore information, matrices, results. Must include elements fluors, , Scale_df, Intensity_mtx, Res, Rename_table. raw_name character string specifying existing fluorophore name replaced. Must exist Userm$fluors Userm$Rename_table. new_name character string specifying new fluorophore name. Must already exist Userm$fluors.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"updated Userm object fluorophore renamed consistently across relevant slots.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"function performs several checks: Ensures arguments provided. Validates raw_name exists Userm$fluors. Ensures new_name already exist Userm$fluors. Updates names fluors, , Scale_df, Intensity_mtx, Res. Updates Rename_table entry fluorophore. renaming successful, message printed console.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/RenameFluor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename a fluorophore in a Userm object ‚Äî RenameFluor","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/robust_pairwise_cov_zscore.html","id":null,"dir":"Reference","previous_headings":"","what":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","title":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","text":"Computes robust covariance matrix calculating pairwise covariances columns, excluding outliers identified via Z-score thresholding. pair variables, rows containing outliers either variable excluded covariance calculation. Diagonal entries filled variance column excluding outliers.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/robust_pairwise_cov_zscore.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","text":"","code":"robust_pairwise_cov_zscore(data, z_thresh = 3)"},{"path":"https://xiangmingcai.github.io/USERM/reference/robust_pairwise_cov_zscore.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","text":"data numeric matrix data frame rows observations columns variables. z_thresh numeric value specifying Z-score threshold outlier detection. Observations absolute Z-scores greater value considered outliers. Default 3.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/robust_pairwise_cov_zscore.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","text":"symmetric covariance matrix robust pairwise estimates.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/robust_pairwise_cov_zscore.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Robust Pairwise Covariance Matrix Using Z-score Outlier Removal ‚Äî robust_pairwise_cov_zscore","text":"","code":"set.seed(123) data <- matrix(rnorm(100 * 5), ncol = 5) data[1:5, ] <- data[1:5, ] + rnorm(5 * 5, sd = 10)  # Inject outliers cov_matrix <- robust_pairwise_cov_zscore(data) print(cov_matrix) #>             V1          V2          V3          V4          V5 #> V1  1.87918786  0.16082475  0.02540392 -0.03690512 -0.40304445 #> V2  0.16082475  1.00996966  0.04786458  0.07554849 -0.16096648 #> V3  0.02540392  0.04786458  1.04540342 -0.09561069 -0.15953374 #> V4 -0.03690512  0.07554849 -0.09561069  1.21467564  0.01297998 #> V5 -0.40304445 -0.16096648 -0.15953374  0.01297998  1.12674036"},{"path":"https://xiangmingcai.github.io/USERM/reference/scale_z.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","title":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","text":"function processes prediction grid filtering scaling z values. first sorts grid descending z, cumulatively sums values specified threshold reached. remaining z values beyond threshold set zero. Finally, remaining z values linearly scaled range 0, 1, maximum value becoming 1. original row order input grid preserved output.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/scale_z.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","text":"","code":"scale_z(grid, threshold = 0.95)"},{"path":"https://xiangmingcai.github.io/USERM/reference/scale_z.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","text":"grid data frame containing columns x, y, z. threshold numeric value 0 1 specifying cumulative proportion z values retain. Default 0.95.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/scale_z.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","text":"data frame structure row order input grid, filtered scaled z values.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/scale_z.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale Z Values with Cumulative Threshold Filtering ‚Äî scale_z","text":"","code":"if (FALSE) { # \\dontrun{ grid <- expand.grid(x = seq(0, 1000, length.out = 50),                     y = seq(0, 1000, length.out = 50)) grid$z <- with(grid, exp(-((x - 500)^2 + (y - 500)^2) / 1e5)) scaled_grid <- scale_z(grid, threshold = 0.95) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/SigList2df.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a list of signature objects into a data frame ‚Äî SigList2df","title":"Convert a list of signature objects into a data frame ‚Äî SigList2df","text":"function takes list signature objects (containing named numeric vector Signature) combines single data frame. column resulting data frame represents one signature, column names assigned based specified identifier field.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SigList2df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a list of signature objects into a data frame ‚Äî SigList2df","text":"","code":"SigList2df(SigList, SigName = \"id\")"},{"path":"https://xiangmingcai.github.io/USERM/reference/SigList2df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a list of signature objects into a data frame ‚Äî SigList2df","text":"SigList list signature objects, containing id, PrimaryName, SecondaryName, named numeric vector Signature. SigName character string specifying identifier use column names output data frame. Must one \"id\", \"PrimaryName\", \"SecondaryName\". Default \"id\". \"id\" recommended consistence following use.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SigList2df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a list of signature objects into a data frame ‚Äî SigList2df","text":"data frame column corresponds signature, row corresponds detector channel.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SigList2df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a list of signature objects into a data frame ‚Äî SigList2df","text":"","code":"if (FALSE) { # \\dontrun{ sig1 <- list(id = \"FITC_CD3\", PrimaryName = \"FITC\", SecondaryName = \"CD3\",              Signature = c(D1 = 0.2, D2 = 0.8)) sig2 <- list(id = \"PE_CD4\", PrimaryName = \"PE\", SecondaryName = \"CD4\",              Signature = c(D1 = 0.5, D2 = 0.5)) sig_df <- SigList2df(list(sig1, sig2), SigName = \"id\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/SlopEstimation.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","title":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","text":"function performs robust estimation slope intercept matrices based residuals signal reconstruction model. bins data using either absolute percentile-based methods, computes robust covariance matrices bin, fits robust linear models estimate relationship covariance values bin midpoints.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SlopEstimation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","text":"","code":"SlopEstimation(   Res,   count_thre,   bin_num = 30,   bin_method = \"percentile\",   z_thre = 3,   ... )"},{"path":"https://xiangmingcai.github.io/USERM/reference/SlopEstimation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","text":"Res result object created CreateRes, containing raw signal matrix R, unmixing matrix , detector information. count_thre integer specifying minimum number data points required bin perform covariance estimation. bin_num integer specifying number bins divide data . Default 30. bin_method character string specifying binning method. Must either \"absolute\" \"percentile\". Default \"percentile\". z_thre numeric threshold removing outliers based z-scores first column matrix B. Default 3. ... Additional arguments passed internal functions (currently unused).","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SlopEstimation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","text":"updated Res object following fields added: bin_mids Midpoints bin used slope estimation. bin_counts Number data points bin. cov_matrices Robust covariance matrices computed bin. interceptMtx Matrix intercepts estimated robust linear models. slopMtx Matrix slopes estimated robust linear models. par list containing binning parameters used estimation.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/SlopEstimation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate slope and intercept matrices from residuals ‚Äî SlopEstimation","text":"","code":"if (FALSE) { # \\dontrun{ Res <- CreateRes(\"F1\", R, A) Res <- SlopEstimation(Res, count_thre = 30, bin_num = 30, bin_method = \"percentile\") } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"function creates HTML representation numeric matrix cell color-coded based value. color legend also appended help interpret color scale.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"","code":"Userm_html_table(   mat,   val_min,   val_mid,   val_max,   colormin,   colormid,   colormax,   Legend = \"Color Legend\" )"},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"mat numeric matrix displayed HTML table. val_min Minimum value color scaling. val_mid Midpoint value color scaling. val_max Maximum value color scaling. colormin Color corresponding val_min. colormid Color corresponding val_mid. colormax Color corresponding val_max. Legend character string legend title. Default \"Color Legend\".","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"character string containing HTML code table legend.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"function useful visualizing matrices heatmap-like color gradient directly Shiny apps HTML reports. relies helper function getColor() compute appropriate background color cell.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Userm_html_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate an HTML table with color-coded cells and a legend ‚Äî Userm_html_table","text":"","code":"mat <- matrix(runif(9, 0, 100), nrow = 3) rownames(mat) <- paste0(\"Row\", 1:3) colnames(mat) <- paste0(\"Col\", 1:3) Userm_html_table(mat, 0, 50, 100, \"#0000FF\", \"#FFFFFF\", \"#FF0000\") #> [1] \"<table style='border-collapse:collapse;'><tr><th><\/th><th class='rotate'><div><span>Col1<\/span><\/div><\/th><th class='rotate'><div><span>Col2<\/span><\/div><\/th><th class='rotate'><div><span>Col3<\/span><\/div><\/th><\/tr><tr><th style = 'white-space: nowrap; text-align: right;'>Row1<\/th><td style='background-color:#FF9494; text-align:center; padding:4px;'>70.89<\/td><td style='background-color:#FFEBEB; text-align:center; padding:4px;'>53.94<\/td><td style='background-color:#FFAEAE; text-align:center; padding:4px;'>65.92<\/td><\/tr><tr><th style = 'white-space: nowrap; text-align: right;'>Row2<\/th><td style='background-color:#FF5858; text-align:center; padding:4px;'>82.67<\/td><td style='background-color:#FFE3E3; text-align:center; padding:4px;'>55.53<\/td><td style='background-color:#7C7CFF; text-align:center; padding:4px;'>24.34<\/td><\/tr><tr><th style = 'white-space: nowrap; text-align: right;'>Row3<\/th><td style='background-color:#FF3737; text-align:center; padding:4px;'>89.19<\/td><td style='background-color:#8D8DFF; text-align:center; padding:4px;'>27.64<\/td><td style='background-color:#9393FF; text-align:center; padding:4px;'>28.83<\/td><\/tr><\/table>\\n                          <div style='margin-top:15px; font-family:Arial; font-size:12px;'>\\n                            <div style='margin-bottom:4px;'>Color Legend<\/div>\\n                            <div style='width:50%; display:flex; justify-content:space-between; margin-top:4px;'>\\n                              <span >0.00<\/span>\\n                              <span >50.00<\/span>\\n                              <span >100.00<\/span>\\n                            <\/div>\\n                            <div style='width:50%; height:20px; background:linear-gradient(to right, #0000FF, #FFFFFF, #FF0000); border:1px solid #ccc;'><\/div>\\n\\n                          <\/div>\\n                        \""},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"function creates heatmap visualization numeric matrix using ComplexHeatmap package. allows customization color scale overlays numeric values cell.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"","code":"Vis_Mtx(   mat = NULL,   min = -1,   mid = 0,   max = 1,   mincolor = \"blue\",   midcolor = \"white\",   maxcolor = \"red\",   title = \"Heatmap\",   legend_name = \"value\" )"},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"mat numeric matrix visualized. Must NULL. min Minimum value color scale. Default -1. mid Midpoint value color scale. Default 0. max Maximum value color scale. Default 1. mincolor Color representing minimum value. Default \"blue\". midcolor Color representing midpoint value. Default \"white\". maxcolor Color representing maximum value. Default \"red\".","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"Heatmap object representing input matrix customized colors cell labels.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"function uses colorRamp2 define color gradient ComplexHeatmap::Heatmap generate heatmap. cell displays numeric value formatted one decimal place. Row column clustering disabled.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/Vis_Mtx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize a Matrix as a Heatmap with Custom Colors and Labels ‚Äî Vis_Mtx","text":"","code":"if (FALSE) { # \\dontrun{ mat <- matrix(runif(25, -1, 1), nrow = 5) Vis_Mtx(mat) } # }"},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"Generates scatter plot comparing signal intensities positive fluorophore (f_pos) negative fluorophore (f_neg) across positive negative control samples. visualization helps assess extent spillover spreading spectral flow cytometry.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"","code":"vis_ss_scatter(ss_output)"},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"ss_output list returned check_ss(), containing unmixed matrices B_pos B_neg, fluorophore names f_pos f_neg, spread metrics.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"ggplot object showing scatter plot f_pos vs f_neg signal intensities, points colored sample group (\"Stain\" positive, \"Reference\" negative).","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"function extracts relevant fluorophore channels unmixed matrices, combines single data frame, plots signal distribution using ggplot2. plot provides intuitive view signal f_pos may spread f_neg, aiding panel design spillover diagnostics.","code":""},{"path":"https://xiangmingcai.github.io/USERM/reference/vis_ss_scatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize Spillover Spreading Between Fluorophores ‚Äî vis_ss_scatter","text":"","code":"if (FALSE) { # \\dontrun{ ss <- check_ss(f_pos = \"FITC\", f_neg = \"PE\", SSM_fluor = c(\"FITC\", \"PE\"),                A = A, custom_ssm_dir = \"~/custom_ssm\") vis_ss_scatter(ss) } # }"}]
