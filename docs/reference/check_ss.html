<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Spillover Spreading Score (SS) Between Fluorophores — check_ss • USERM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Spillover Spreading Score (SS) Between Fluorophores — check_ss"><meta name="description" content="This function calculates the spillover spreading score (SS) between a primary fluorophore (f_pos)
and a secondary fluorophore (f_neg) using precomputed SSM objects and an unmixing matrix A.
It supports both built-in and custom SSM sources, and performs detector-to-fluorophore unmixing
followed by quantile-based spread estimation."><meta property="og:description" content="This function calculates the spillover spreading score (SS) between a primary fluorophore (f_pos)
and a secondary fluorophore (f_neg) using precomputed SSM objects and an unmixing matrix A.
It supports both built-in and custom SSM sources, and performs detector-to-fluorophore unmixing
followed by quantile-based spread estimation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">USERM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/instruction_basic.html">Basic Instruction</a></li>
    <li><a class="dropdown-item" href="../articles/instruction_customFCS.html">Use Custom SCC</a></li>
    <li><a class="dropdown-item" href="../articles/instruction_interprateHighCoef.html">Interprate Spread</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xiangmingcai/USERM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute Spillover Spreading Score (SS) Between Fluorophores</h1>
      <small class="dont-index">Source: <a href="https://github.com/xiangmingcai/USERM/blob/HEAD/R/check_ss.R" class="external-link"><code>R/check_ss.R</code></a></small>
      <div class="d-none name"><code>check_ss.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates the spillover spreading score (SS) between a primary fluorophore (<code>f_pos</code>)
and a secondary fluorophore (<code>f_neg</code>) using precomputed SSM objects and an unmixing matrix <code>A</code>.
It supports both built-in and custom SSM sources, and performs detector-to-fluorophore unmixing
followed by quantile-based spread estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_ss</span><span class="op">(</span><span class="va">f_pos</span>, <span class="va">f_neg</span>, <span class="va">SSM_fluor</span>, <span class="va">A</span>, <span class="va">Userm</span>, custom_ssm_dir <span class="op">=</span> <span class="cn">NULL</span>, mSS <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-f-pos">f_pos<a class="anchor" aria-label="anchor" href="#arg-f-pos"></a></dt>
<dd><p>A character string specifying the positive fluorophore (positive channel).</p></dd>


<dt id="arg-f-neg">f_neg<a class="anchor" aria-label="anchor" href="#arg-f-neg"></a></dt>
<dd><p>A character string specifying the negative fluorophore (negative channel).</p></dd>


<dt id="arg-ssm-fluor">SSM_fluor<a class="anchor" aria-label="anchor" href="#arg-ssm-fluor"></a></dt>
<dd><p>A character vector of fluorophores required for SSM computation. Used for availability checks.</p></dd>


<dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>A numeric matrix representing the detector-to-fluorophore unmixing matrix. Row names must be detector names; column names must be fluorophore names.</p></dd>


<dt id="arg-custom-ssm-dir">custom_ssm_dir<a class="anchor" aria-label="anchor" href="#arg-custom-ssm-dir"></a></dt>
<dd><p>Optional path to a directory containing custom SSM <code>.rds</code> files. Default is <code>NULL</code>.</p></dd>


<dt id="arg-mss">mSS<a class="anchor" aria-label="anchor" href="#arg-mss"></a></dt>
<dd><p>Modified Spread error. Default is TRUE. If set to FALSE, original Spread error will be calculated.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>f_pos</dt>
<dd><p>positive fluorophore name.</p></dd>

<dt>f_neg</dt>
<dd><p>negative fluorophore name.</p></dd>

<dt>B_pos</dt>
<dd><p>Unmixed positive sample matrix (cells × fluorophores).</p></dd>

<dt>B_neg</dt>
<dd><p>Unmixed negative sample matrix (cells × fluorophores).</p></dd>

<dt>R_F_neg_84</dt>
<dd><p>84th percentile of <code>f_neg</code> in negative samples.</p></dd>

<dt>R_F_neg_50</dt>
<dd><p>Median of <code>f_neg</code> in negative samples.</p></dd>

<dt>R_sigma_F_neg</dt>
<dd><p>Spread of <code>f_neg</code> in negative samples.</p></dd>

<dt>S_F_neg_84</dt>
<dd><p>84th percentile of <code>f_neg</code> in positive samples.</p></dd>

<dt>S_F_neg_50</dt>
<dd><p>Median of <code>f_neg</code> in positive samples.</p></dd>

<dt>S_sigma_F_neg</dt>
<dd><p>Spread of <code>f_neg</code> in positive samples.</p></dd>

<dt>S_F_pos_50</dt>
<dd><p>Median of <code>f_pos</code> in positive samples.</p></dd>

<dt>R_F_pos_50</dt>
<dd><p>Median of <code>f_pos</code> in negative samples.</p></dd>

<dt>delta_F_pos</dt>
<dd><p>Difference in median signal of <code>f_pos</code> between positive and negative samples.</p></dd>

<dt>delta_sigma_F_neg_2</dt>
<dd><p>Difference in squared spread of <code>f_neg</code> between positive and negative samples.</p></dd>

<dt>ss_2</dt>
<dd><p>Intermediate SS score before square root transformation.</p></dd>

<dt>ss</dt>
<dd><p>Final spillover spreading score.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For the detailed explanation of returned items, please refer to Fig1A of Nguyen, Perfetto et al. Quantifying Spillover Spreading for Comparing Instrument Performance and Aiding in Multicolor Panel Design”. Cytometry A. 2013.</p>
<p>The function loads SSM objects for the specified fluorophores, checks detector compatibility with the unmixing matrix,
performs matrix inversion and unmixing, and computes quantile-based spread metrics. The SS score is derived from
the change in spread of the negative channel (<code>f_neg</code>) relative to the signal increase in the positive channel (<code>f_pos</code>).</p>
<p>If <code>f_pos == f_neg</code>, the score is set to zero and all intermediate metrics are returned as <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Det"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FITC"</span>, <span class="st">"PE"</span>, <span class="st">"APC"</span>, <span class="st">"PerCP"</span>, <span class="st">"BV421"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">check_ss</span><span class="op">(</span>f_pos <span class="op">=</span> <span class="st">"FITC"</span>, f_neg <span class="op">=</span> <span class="st">"PE"</span>, SSM_fluor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FITC"</span>, <span class="st">"PE"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         A <span class="op">=</span> <span class="va">A</span>, custom_ssm_dir <span class="op">=</span> <span class="st">"~/custom_ssm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/xiangmingcai" class="external-link">Xiangming Cai</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

