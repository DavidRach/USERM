<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Interprate Spread ‚Ä¢ USERM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interprate Spread">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">USERM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/instruction_basic.html">Basic Instruction</a></li>
    <li><a class="dropdown-item" href="../articles/instruction_customFCS.html">Use Custom SCC</a></li>
    <li><a class="dropdown-item" href="../articles/instruction_interprateHighCoef.html">Interprate Spread</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xiangmingcai/USERM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Interprate Spread</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/xiangmingcai/USERM/blob/HEAD/vignettes/instruction_interprateHighCoef.Rmd" class="external-link"><code>vignettes/instruction_interprateHighCoef.Rmd</code></a></small>
      <div class="d-none name"><code>instruction_interprateHighCoef.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="interprate-the-observed-spread-with-userm">Interprate the observed spread with USERM<a class="anchor" aria-label="anchor" href="#interprate-the-observed-spread-with-userm"></a>
</h2>
<p>Xiangming Cai</p>
<p>2025-11-22</p>
<div class="section level3">
<h3 id="introduction">üîç Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This instruction will show a case about how to interprate a high Coef
value found in the Coef Matrix. Of note, here we only show how to check
the reason of observed high spread. Strategy for panel adjustment is out
of the scope of this instruction.</p>
<p>For basic instruction of the USERM, please refer to the basic <a href="../instruction_basic.html">instruction</a>.</p>
</div>
<div class="section level3">
<h3 id="an-example-with-high-coef-value">üíª An example with high Coef value<a class="anchor" aria-label="anchor" href="#an-example-with-high-coef-value"></a>
</h3>
<div class="section level4">
<h4 id="create-a-panel">create a panel<a class="anchor" aria-label="anchor" href="#create-a-panel"></a>
</h4>
<p>Here we will use the USERM to make a 20 color + AF panel for Aurora
5L.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xiangmingcai.github.io/USERM">USERM</a></span><span class="op">)</span></span>
<span><span class="co"># Step 1 querySig</span></span>
<span><span class="va">Sig_info</span> <span class="op">=</span> <span class="fu"><a href="../reference/querySig.html">querySig</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Sig_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2 Select fluors and create UsermObj</span></span>
<span><span class="va">fluors_selected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Sig_info</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">149</span>,<span class="fl">201</span>,<span class="fl">150</span>,<span class="fl">151</span>,</span>
<span>                                  <span class="fl">152</span>,<span class="fl">153</span>,<span class="fl">154</span>,<span class="fl">155</span>,</span>
<span>                                  <span class="fl">156</span>,<span class="fl">157</span>,<span class="fl">158</span>,<span class="fl">159</span>,</span>
<span>                                  <span class="fl">160</span>,<span class="fl">161</span>,<span class="fl">162</span>,<span class="fl">163</span>,</span>
<span>                                  <span class="fl">189</span>,<span class="fl">200</span>,<span class="fl">196</span>,<span class="fl">199</span>,<span class="fl">138</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fluors_selected</span><span class="op">)</span></span>
<span><span class="va">Sig_mtx</span>  <span class="op">=</span> <span class="fu"><a href="../reference/getSigMtx.html">getSigMtx</a></span><span class="op">(</span>ids <span class="op">=</span> <span class="va">fluors_selected</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Sig_mtx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UsermObj</span> <span class="op">=</span> <span class="fu"><a href="../reference/CreateUserm.html">CreateUserm</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">Sig_mtx</span><span class="op">)</span></span>
<span><span class="co">#add ResObj into UsermObj</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">save_suf</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Sig_mtx</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ResObj</span> <span class="op">=</span> <span class="fu"><a href="../reference/getRes.html">getRes</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">save_suf</span><span class="op">)</span></span>
<span>  <span class="va">UsermObj</span> <span class="op">=</span> <span class="fu"><a href="../reference/AddRes2Userm.html">AddRes2Userm</a></span><span class="op">(</span>Res <span class="op">=</span> <span class="va">ResObj</span>, Userm <span class="op">=</span> <span class="va">UsermObj</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Step 4 matrics estimation and visualization</span></span>
<span><span class="va">Coef_mtx</span> <span class="op">=</span> <span class="fu"><a href="../reference/EstimateCoefMtx.html">EstimateCoefMtx</a></span><span class="op">(</span>Userm <span class="op">=</span> <span class="va">UsermObj</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">Coef_mtx</span>,mincolor <span class="op">=</span> <span class="st">"white"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">20</span>,mid <span class="op">=</span> <span class="fl">10</span>,min <span class="op">=</span> <span class="fl">0</span>,legend_name <span class="op">=</span> <span class="st">"Coef"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Coefficient of residual model matrix (Coef Matrix) (row spread into column)"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(Sig_info)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                    id PrimaryName SecondaryName detectors instrument       Source Note</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="dv">1</span>  SCC_Bead_CD4_NFR700         CD4        NFR700        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="dv">2</span>   SCC_Bead_CD3_BV510         CD3         BV510        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="dv">3</span>    SCC_Bead_CD2_FITC         CD2          FITC        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="dv">4</span>       SCC_Bead_AF_AF          AF            AF        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="dv">5</span>   SCC_Bead_CD8_BV570         CD8         BV570        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="dv">6</span> SCC_Bead_CD16_BUV805        CD16        BUV805        <span class="dv">51</span>     Xenith XiangmingCai   <span class="cn">NA</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(fluors_selected)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"SCC3_Cell_BUV395_CD4"</span>    <span class="st">"SCC3_Cell_LDBlue_LD"</span>     <span class="st">"SCC3_Cell_BUV496_CD4"</span>   </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a> [<span class="dv">4</span>] <span class="st">"SCC3_Cell_BUV563_CD4"</span>    <span class="st">"SCC3_Cell_BUV615_CD4"</span>    <span class="st">"SCC3_Cell_BUV661_CD4"</span>   </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">"SCC3_Cell_BUV737_CD4"</span>    <span class="st">"SCC3_Cell_BUV805_CD4"</span>    <span class="st">"SCC3_Cell_BV421_CD4"</span>    </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">"SCC3_Cell_BV480_CD4"</span>     <span class="st">"SCC3_Cell_BV510_CD4"</span>     <span class="st">"SCC3_Cell_BV605_CD4"</span>    </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">"SCC3_Cell_BV650_CD4"</span>     <span class="st">"SCC3_Cell_BV711_CD4"</span>     <span class="st">"SCC3_Cell_BV750_CD4"</span>    </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>[<span class="dv">16</span>] <span class="st">"SCC3_Cell_BV786_CD4"</span>     <span class="st">"SCC3_Cell_FITC_CD4"</span>      <span class="st">"SCC3_Cell_PerCPCy55_CD4"</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">"SCC3_Cell_PE_CD4"</span>        <span class="st">"SCC3_Cell_PECy7_CD4"</span>     <span class="st">"SCC3_Cell_AF_AF"</span>  </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dim</span>(Sig_mtx)</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">64</span> <span class="dv">21</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_coef_mtx.jpg" width="800/"></p>

<p>From the Coef Matrix, we find the high Coef value of PECy7 spread
into BV510, which equals to 71.3. On the contrary, the coef value of
PECy7 spread into BV480 is very low, which equals to 1.0.</p>
</div>
<div class="section level4">
<h4 id="verify-the-high-coef-value">verify the high coef value<a class="anchor" aria-label="anchor" href="#verify-the-high-coef-value"></a>
</h4>
<p>We will first verify the spread at a single-color control (SCC)
setting (PECy7). Then we will use the USERM to look for the reason of
this high coef value, so that we can understand why there is a high
spread from PECy7 into BV510.</p>
<p>To make a single-color control setting, we can create 3 SCC
populations first.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create 3 populations with all zero fluroescence intensities</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># assign 100, 500, 1000 to the PECy7 intensities of these 3 populations</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="va">UsermObj</span><span class="op">$</span><span class="va">Intensity_mtx</span><span class="op">[</span><span class="fl">20</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">UsermObj</span><span class="op">[[</span><span class="st">"Intensity_mtx"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(UsermObj[[<span class="st">"Intensity_mtx"</span>]])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                         V1  V2   V3</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>SCC3_Cell_BUV395_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>SCC3_Cell_LDBlue_LD       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>SCC3_Cell_BUV496_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>SCC3_Cell_BUV563_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>SCC3_Cell_BUV615_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>SCC3_Cell_BUV661_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>SCC3_Cell_BUV737_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>SCC3_Cell_BUV805_CD4      <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>SCC3_Cell_BV421_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>SCC3_Cell_BV480_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>SCC3_Cell_BV510_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>SCC3_Cell_BV605_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>SCC3_Cell_BV650_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>SCC3_Cell_BV711_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>SCC3_Cell_BV750_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>SCC3_Cell_BV786_CD4       <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>SCC3_Cell_FITC_CD4        <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>SCC3_Cell_PerCPCy55_CD4   <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>SCC3_Cell_PE_CD4          <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>SCC3_Cell_PECy7_CD4     <span class="dv">100</span> <span class="dv">500</span> <span class="dv">1000</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>SCC3_Cell_AF_AF           <span class="dv">0</span>   <span class="dv">0</span>    <span class="dv">0</span></span></code></pre></div>
<p>Now, we can predict the spread of these 3 populations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PredMultipleSpread.html">PredMultipleSpread</a></span><span class="op">(</span>Userm <span class="op">=</span> <span class="va">UsermObj</span>,population_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>,<span class="st">"V2"</span>,<span class="st">"V3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Set the <strong><em>Factor for default Autofluorescence</em></strong>
to be 0, so that we remove the spread from intercept matrix, which
represents the spread from AF. Adjust the range of axes and we can saw
this predicted plot:</p>
<p align="center">
</p>
<p><img src="./images/inteprate_predict_high.jpg" width="800/"></p>

<p>The plot shows an increasing trend in the spread from PECy7 into
BV510 as the fluorescence intensity of PECy7 increases. Now we can
switch the x axis to BV480.</p>
<p align="center">
</p>
<p><img src="./images/inteprate_predict_low.jpg" width="800/"></p>

<p>From the plot, it is clear that the PECy7 barely spread into BV480,
compared to that for BV510. These observation verify what we find in the
coef matrix.</p>
<p>New we want to know why there is a high spread from PECy7 into
BV510.</p>
</div>
</div>
<div class="section level3">
<h3 id="why-there-is-a-high-spread">Why there is a high spread?<a class="anchor" aria-label="anchor" href="#why-there-is-a-high-spread"></a>
</h3>
<p>Let‚Äôs first take a look at the key part of the residual model<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker,
Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation.&lt;/p&gt;"><sup>1</sup></a>, which is
used to predict the spread from a SCC fluorescence
<strong><em>h</em></strong> (PECy7) into the fluorescence
<strong><em>k</em></strong> (BV510):</p>
<p align="center">
</p>
<p><img src="./images/inteprate_formula1.jpg" width="200/"></p>

<p>In this formulation,
<img src="./images/inteprate_formula2.jpg" height="20/"> is the
intensity of fluroescence <strong><em>h</em></strong>.
<img src="./images/inteprate_formula6.jpg" height="20/"> is the
pseudo-inverse of the signature matrix
<img src="./images/inteprate_formula7.jpg" height="20/">.
<img src="./images/inteprate_formula3.jpg" height="20/"> is the
<strong><em>k</em></strong>-th row of the pseudo-inverse
<img src="./images/inteprate_formula6.jpg" height="20/">. The
<img src="./images/inteprate_formula4.jpg" height="20/"> is the slope
matrix (will explain later). And the
<img src="./images/inteprate_formula5.jpg" height="20/"> is the
transpose of the
<img src="./images/inteprate_formula3.jpg" height="20/">. The
multiplied results of them is the predicted spread from the fluorescence
<strong><em>h</em></strong> into fluorescence
<strong><em>k</em></strong>.</p>
<p>For detailed explanation of the Matrix multiplication, please check
the <a href="https://en.wikipedia.org/wiki/Matrix_multiplication" class="external-link">Matrix
multiplication</a></p>
<p>Now, let‚Äôs visualize these matrixes to have a clear understanding of
them. I will circle the key components from the matrixes.</p>
<div class="section level4">
<h4 id="signature-matrix">1. signature matrix<a class="anchor" aria-label="anchor" href="#signature-matrix"></a>
</h4>
<p>We can first visualize the signature matrix, this is simply the
signatures of all fluorescence in the panel.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">A</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">A</span>,mincolor <span class="op">=</span> <span class="st">"white"</span>,midcolor <span class="op">=</span> <span class="st">"#D03E4C"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0.5</span>,min <span class="op">=</span> <span class="fl">0</span>,legend_name <span class="op">=</span> <span class="st">"Signal"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Signature matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_sigmtx.jpg" height="800/"></p>

</div>
<div class="section level4">
<h4 id="pseudo-inverse-matrix">2. pseudo-inverse matrix<a class="anchor" aria-label="anchor" href="#pseudo-inverse-matrix"></a>
</h4>
<p>Now, we calculate the pseudo-inverse of the signature matrix. For
detailed explanation of the pseudo-inverse, please check the <a href="https://en.wikipedia.org/wiki/Generalized_inverse" class="external-link">Generalized-inverse</a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="va">A_pinv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">ginv</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">A_pinv</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">A_pinv</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">A_pinv</span>,mincolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0</span>,min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,legend_name <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Pseudo-inverse matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_pinvmtx.jpg" width="800/"></p>

<p>The circled line is the
<img src="./images/inteprate_formula3.jpg" height="20/">.</p>
</div>
<div class="section level4">
<h4 id="slope-matrix">3. slope matrix<a class="anchor" aria-label="anchor" href="#slope-matrix"></a>
</h4>
<p>Following the order of the components in the formula, we can now
visualize the slope matrix of the fluorescence
<strong><em>h</em></strong>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slop_mtx</span> <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">Res</span><span class="op">$</span><span class="va">SCC3_Cell_PECy7_CD4</span><span class="op">$</span><span class="va">slopMtx</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">slop_mtx</span>,mincolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0</span>,min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,legend_name <span class="op">=</span> <span class="st">"beta"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"slope matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_slopmtx.jpg" width="800/"></p>

<p>The whole matrix is the slope matrix. The
<strong><em>slope</em></strong> matrix is a <strong><em>m</em></strong>
detectors x <strong><em>m</em></strong> detectors matrix. Each detector
has its own residual signals (see <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker,
Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation.&lt;/p&gt;"><sup>2</sup></a>), which accounts to the spread in
fluroescence <strong><em>k</em></strong>. The covariance between
detector <strong><em>i</em></strong> and detector
<strong><em>j</em></strong> will be calculated. The covariance is
linearly related to the intensity of fluorescence
<strong><em>h</em></strong>. A linear model is fit to describe the
relationship and generate a slope value (beta). So, in the
<strong><em>slope</em></strong> matrix, a slope value represents the
linear relationship between the covariance of corresponding pair of
detectors versus the intensity of fluorescence
<strong><em>h</em></strong>.</p>
<p>We can visualized the linear relationship between the covariance of
B13-A and B14-A versus the fluorescence intensity of the fluorescence
<strong><em>h</em></strong> (PECy7):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ResObj</span> <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">Res</span><span class="op">$</span><span class="va">SCC3_Cell_PECy7_CD4</span></span>
<span><span class="va">ResObj</span><span class="op">$</span><span class="va">detectors</span></span>
<span><span class="fu"><a href="../reference/checkRes_covScatter.html">checkRes_covScatter</a></span><span class="op">(</span>Res <span class="op">=</span> <span class="va">ResObj</span>,</span>
<span>                    detector1 <span class="op">=</span> <span class="st">"B13-A"</span>,</span>
<span>                    detector2 <span class="op">=</span> <span class="st">"B14-A"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> ResObj<span class="sc">$</span>detectors</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">"UV1-A"</span>  <span class="st">"UV2-A"</span>  <span class="st">"UV3-A"</span>  <span class="st">"UV4-A"</span>  <span class="st">"UV5-A"</span>  <span class="st">"UV6-A"</span>  <span class="st">"UV7-A"</span>  <span class="st">"UV8-A"</span>  <span class="st">"UV9-A"</span>  <span class="st">"UV10-A"</span> <span class="st">"UV11-A"</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>[<span class="dv">12</span>] <span class="st">"UV12-A"</span> <span class="st">"UV13-A"</span> <span class="st">"UV14-A"</span> <span class="st">"UV15-A"</span> <span class="st">"UV16-A"</span> <span class="st">"V1-A"</span>   <span class="st">"V2-A"</span>   <span class="st">"V3-A"</span>   <span class="st">"V4-A"</span>   <span class="st">"V5-A"</span>   <span class="st">"V6-A"</span>  </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>[<span class="dv">23</span>] <span class="st">"V7-A"</span>   <span class="st">"V8-A"</span>   <span class="st">"V9-A"</span>   <span class="st">"V10-A"</span>  <span class="st">"V11-A"</span>  <span class="st">"V12-A"</span>  <span class="st">"V13-A"</span>  <span class="st">"V14-A"</span>  <span class="st">"V15-A"</span>  <span class="st">"V16-A"</span>  <span class="st">"B1-A"</span>  </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>[<span class="dv">34</span>] <span class="st">"B2-A"</span>   <span class="st">"B3-A"</span>   <span class="st">"B4-A"</span>   <span class="st">"B5-A"</span>   <span class="st">"B6-A"</span>   <span class="st">"B7-A"</span>   <span class="st">"B8-A"</span>   <span class="st">"B9-A"</span>   <span class="st">"B10-A"</span>  <span class="st">"B11-A"</span>  <span class="st">"B12-A"</span> </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>[<span class="dv">45</span>] <span class="st">"B13-A"</span>  <span class="st">"B14-A"</span>  <span class="st">"YG1-A"</span>  <span class="st">"YG2-A"</span>  <span class="st">"YG3-A"</span>  <span class="st">"YG4-A"</span>  <span class="st">"YG5-A"</span>  <span class="st">"YG6-A"</span>  <span class="st">"YG7-A"</span>  <span class="st">"YG8-A"</span>  <span class="st">"YG9-A"</span> </span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>[<span class="dv">56</span>] <span class="st">"YG10-A"</span> <span class="st">"R1-A"</span>   <span class="st">"R2-A"</span>   <span class="st">"R3-A"</span>   <span class="st">"R4-A"</span>   <span class="st">"R5-A"</span>   <span class="st">"R6-A"</span>   <span class="st">"R7-A"</span>   <span class="st">"R8-A"</span> </span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_scatter.jpg" width="800/"></p>

</div>
<div class="section level4">
<h4 id="transpose-of-the-pseudo-inverse-matrix">4. transpose of the pseudo-inverse matrix<a class="anchor" aria-label="anchor" href="#transpose-of-the-pseudo-inverse-matrix"></a>
</h4>
<p>Now, we continue with the last component in the formula, transpose of
the pseudo-inverse matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A_pinv_t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">A_pinv</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">A_pinv_t</span>,mincolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0</span>,min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,legend_name <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"transpose of Pseudo-inverse matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_t_pinvmtx.jpg" height="800/"></p>

<p>The circled column is the
<img src="./images/inteprate_formula5.jpg" height="20/">.</p>
</div>
<div class="section level4">
<h4 id="sum-of-the-weighted-slope-matrix-represents-the-observed-spread">5. sum of the weighted slope matrix represents the observed
spread<a class="anchor" aria-label="anchor" href="#sum-of-the-weighted-slope-matrix-represents-the-observed-spread"></a>
</h4>
<div class="section level5">
<h5 id="reshape-formula">5.1 reshape formula<a class="anchor" aria-label="anchor" href="#reshape-formula"></a>
</h5>
To better understand the formula, we can reshape it as:
<p align="center">
</p>
<p><img src="./images/inteprate_formula8.jpg" width="600/"></p>

<p>The indices <strong><em>i</em></strong> and
<strong><em>j</em></strong> represents the
<strong><em>i</em></strong>-th row and <strong><em>j</em></strong>-th
column in the slope matrix. The formula can be interpreted as the sum
over the weighted slope matrix, where the weight is the product of the
<strong><em>i</em></strong>-th and <strong><em>j</em></strong>-th values
in the <img src="./images/inteprate_formula3.jpg" height="20/">.</p>
</div>
<div class="section level5">
<h5 id="weight-matrix">5.2 weight matrix<a class="anchor" aria-label="anchor" href="#weight-matrix"></a>
</h5>
<p>We can compute the weight matrix, in which the value in the
<strong><em>i</em></strong>-th row and <strong><em>j</em></strong>-th
column is the product of the <strong><em>i</em></strong>-th and
<strong><em>j</em></strong>-th value in the
<img src="./images/inteprate_formula3.jpg" height="20/"> :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_mtx</span> <span class="op">=</span> <span class="va">A_pinv</span><span class="op">[</span><span class="st">"SCC3_Cell_BV510_CD4"</span>,<span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/outer.html" class="external-link">%o%</a></span> <span class="va">A_pinv</span><span class="op">[</span><span class="st">"SCC3_Cell_BV510_CD4"</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">weight_mtx</span>,mincolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0</span>,min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,legend_name <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"weight matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_weightmtx.jpg" width="800/"></p>

<p>We can immediately find that most of the values in the weight matrix
is zero. For detailed explanation of the outer product conducted here,
please check the <a href="https://en.wikipedia.org/wiki/Outer_product" class="external-link">Outer Product</a></p>
</div>
<div class="section level5">
<h5 id="weighted-slope-matrix">5.3 weighted slope matrix<a class="anchor" aria-label="anchor" href="#weighted-slope-matrix"></a>
</h5>
<p>We can further visualize the weighted slope matrix:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weighted_slope_mtx</span> <span class="op">=</span> <span class="va">weight_mtx</span> <span class="op">*</span> <span class="va">slop_mtx</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">weighted_slope_mtx</span>,mincolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#B02B38"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">10</span>,mid <span class="op">=</span> <span class="fl">0</span>,min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,legend_name <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"weighted slop matrix"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weighted_slope_mtx</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sum</span>(weighted_slope_mtx)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">71.32371</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprate_weightslopemtx.jpg" width="800/"></p>

<p>The sum of all values in the weighted slope matrix is the predicted
spread from fluorescence <strong><em>h</em></strong> into fluorescence
<strong><em>k</em></strong>. These values can be negative, 0, or
positive. It is obvious that only few values contribute to the overall
sum. These contributing values correspond to detector pairs of B12-A,
B13-A, B14-A, and YG10-A.</p>
<blockquote>
<p>In conclusion, the high spread from fluorescence
<strong><em>h</em></strong> (PECy7) into fluorescence
<strong><em>k</em></strong> (BV510) is related to the circled value in
the peseudo-inverse matrix and the slop matrix.</p>
</blockquote>
<blockquote>
<p>In another word, it is not only influenced by the overall signature
matrix, but also by the linear relationship between the covariance among
residual signals of detector B12-A, B13-A, B14-A, and YG10-A and the
intensity of fluorescence <strong><em>h</em></strong> (PECy7).</p>
</blockquote>
</div>
</div>
<div class="section level4">
<h4 id="compare-the-coef-with-other-tools">6. compare the coef with other tools<a class="anchor" aria-label="anchor" href="#compare-the-coef-with-other-tools"></a>
</h4>
<div class="section level5">
<h5 id="fluorescence-signature">6.1 fluorescence signature<a class="anchor" aria-label="anchor" href="#fluorescence-signature"></a>
</h5>
<p>We can check the signature of PECy7:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/checkSig_linePlot.html">checkSig_linePlot</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"SCC3_Cell_PECy7_CD4"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprateresult_sig.jpg" width="800/"></p>

<p>Some peak channels appear to be related to our conclusion, although
the connection remains unclear.</p>
</div>
<div class="section level5">
<h5 id="similarity-matrix">6.2 similarity matrix<a class="anchor" aria-label="anchor" href="#similarity-matrix"></a>
</h5>
<p>To check the similarity matrix:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Similarity_mtx</span> <span class="op">=</span> <span class="fu"><a href="../reference/EstimateSimilarityMtx.html">EstimateSimilarityMtx</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">Similarity_mtx</span>,mincolor <span class="op">=</span> <span class="st">"white"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">1</span>,mid <span class="op">=</span> <span class="fl">0.8</span>,min <span class="op">=</span> <span class="fl">0</span>,legend_name <span class="op">=</span> <span class="st">"Cosine"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Cosine similarity matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprateresult_similaritymtx.jpg" width="800/"></p>

<p>No clear conflicting fluorescence were found.</p>
</div>
<div class="section level5">
<h5 id="hotspot-matrix">6.3 Hotspot matrix<a class="anchor" aria-label="anchor" href="#hotspot-matrix"></a>
</h5>
<p>To check the Hotspot matrix:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hotspot_mtx</span> <span class="op">=</span> <span class="fu"><a href="../reference/EstimateHotspotMtx.html">EstimateHotspotMtx</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">UsermObj</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co"># pdf(file = "E:/ResidualModel/HotspotMtx.pdf",width = 10,height = 10)</span></span>
<span><span class="fu"><a href="../reference/Vis_Mtx.html">Vis_Mtx</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">Hotspot_mtx</span>,mincolor <span class="op">=</span> <span class="st">"white"</span>,midcolor <span class="op">=</span> <span class="st">"white"</span>, maxcolor <span class="op">=</span> <span class="st">"#95ABDB"</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">2</span>,mid <span class="op">=</span> <span class="fl">1</span>,min <span class="op">=</span> <span class="fl">0</span>,legend_name <span class="op">=</span> <span class="st">"Hotspot"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Hotspot matrix"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="./images/inteprateresult_hotspotmtx.jpg" width="800/"></p>

<p>The spread from PECy7 into BV510 was not identified.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="perspective">Perspective<a class="anchor" aria-label="anchor" href="#perspective"></a>
</h3>
<p>We think the Coef Matrix can be a good complementary to available
tools. We want to encourage researchers to use all of these tools for
panel design and optimize unmixed results if possible. The USERM package
can be an out-of-box tool to apply these commonly used tools and makes
the panel design better.</p>
</div>
<div class="section level3">
<h3 id="citation">üìö Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h3>
<p>If you use this package in your research, please cite our paper and
the package as:</p>
<pre><code>Xiangming Cai, Sara Garcia-Garcia, Nick Rohrbacker, Michaela Gianniou, Juan J. Garcia Vallejo. Manuscript in preparation. (to be update)

Cai X (2025). _USERM: Unmixing Spread Estimation with Residual Model_. R package version
  1.0.0,  &lt;https://github.com/xiangmingcai/USERM&gt;.
  
@Manual{,
    title = {USERM: Unmixing Spread Estimation with Residual Model},
    author = {Xiangming Cai},
    year = {2025},
    note = {R package version 1.0.0},
    url = {https://github.com/xiangmingcai/USERM},
  }</code></pre>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/xiangmingcai" class="external-link">Xiangming Cai</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
