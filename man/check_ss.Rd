% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_ss.R
\name{check_ss}
\alias{check_ss}
\title{Compute Spillover Spreading Score (SS) Between Fluorophores}
\usage{
check_ss(f_pos, f_neg, SSM_fluor, A, Userm, custom_ssm_dir = NULL)
}
\arguments{
\item{f_pos}{A character string specifying the positive fluorophore (positive channel).}

\item{f_neg}{A character string specifying the negative fluorophore (negative channel).}

\item{SSM_fluor}{A character vector of fluorophores required for SSM computation. Used for availability checks.}

\item{A}{A numeric matrix representing the detector-to-fluorophore unmixing matrix. Row names must be detector names; column names must be fluorophore names.}

\item{custom_ssm_dir}{Optional path to a directory containing custom SSM \code{.rds} files. Default is \code{NULL}.}
}
\value{
A list containing:
\item{f_pos}{positive fluorophore name.}
\item{f_neg}{negative fluorophore name.}
\item{B_pos}{Unmixed positive sample matrix (cells × fluorophores).}
\item{B_neg}{Unmixed negative sample matrix (cells × fluorophores).}
\item{R_F_neg_84}{84th percentile of \code{f_neg} in negative samples.}
\item{R_F_neg_50}{Median of \code{f_neg} in negative samples.}
\item{R_sigma_F_neg}{Spread of \code{f_neg} in negative samples.}
\item{S_F_neg_84}{84th percentile of \code{f_neg} in positive samples.}
\item{S_F_neg_50}{Median of \code{f_neg} in positive samples.}
\item{S_sigma_F_neg}{Spread of \code{f_neg} in positive samples.}
\item{S_F_pos_50}{Median of \code{f_pos} in positive samples.}
\item{R_F_pos_50}{Median of \code{f_pos} in negative samples.}
\item{delta_F_pos}{Difference in median signal of \code{f_pos} between positive and negative samples.}
\item{delta_sigma_F_neg_2}{Difference in squared spread of \code{f_neg} between positive and negative samples.}
\item{ss_2}{Intermediate SS score before square root transformation.}
\item{ss}{Final spillover spreading score.}
}
\description{
This function calculates the spillover spreading score (SS) between a primary fluorophore (\code{f_pos})
and a secondary fluorophore (\code{f_neg}) using precomputed SSM objects and an unmixing matrix \code{A}.
It supports both built-in and custom SSM sources, and performs detector-to-fluorophore unmixing
followed by quantile-based spread estimation.
}
\details{
For the detailed explanation of returned items, please refer to Fig1A of Nguyen, Perfetto et al. Quantifying Spillover Spreading for Comparing Instrument Performance and Aiding in Multicolor Panel Design”. Cytometry A. 2013.

The function loads SSM objects for the specified fluorophores, checks detector compatibility with the unmixing matrix,
performs matrix inversion and unmixing, and computes quantile-based spread metrics. The SS score is derived from
the change in spread of the negative channel (\code{f_neg}) relative to the signal increase in the positive channel (\code{f_pos}).

If \code{f_pos == f_neg}, the score is set to zero and all intermediate metrics are returned as \code{NA}.
}
\examples{
\dontrun{
A <- matrix(runif(25), nrow = 5)
rownames(A) <- paste0("Det", 1:5)
colnames(A) <- c("FITC", "PE", "APC", "PerCP", "BV421")
check_ss(f_pos = "FITC", f_neg = "PE", SSM_fluor = c("FITC", "PE"),
         A = A, custom_ssm_dir = "~/custom_ssm")
}
}
