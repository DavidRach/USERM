% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EstimateDistance.R
\name{EstimateDistance}
\alias{EstimateDistance}
\title{Estimate Elliptical Distance Between Two USERM Spread Objects}
\usage{
EstimateDistance(Spr1, Spr2)
}
\arguments{
\item{Spr1}{A spread object generated by \code{EstimateSpread()}, containing intensity and variance information for a population.}

\item{Spr2}{Another spread object generated by \code{EstimateSpread()}, to be compared with \code{Spr1}.}
}
\value{
A square numeric matrix with fluorochrome names as row and column names. Each entry represents
the elliptical distance ratio between a pair of fluorochromes in \code{Spr1} and \code{Spr2}.
}
\description{
This function computes a distance matrix between fluorochrome pairs based on the geometric
relationship of their signal ellipses in two USERM spread objects (Spr). The distance is defined
as the ratio between the center-to-center distance and the sum of the ellipse radii along
the connecting line. A value less than 1 indicates overlapping ellipses.
}
\details{
The function checks that both spread objects contain the same set of fluorochromes.
For each fluorochrome pair, it calculates:
\itemize{
\item The center positions from intensity values.
\item The ellipse radii from the square root of summed intercept and slope variances.
\item The distance between ellipse centers.
\item The sum of half-lengths of the line segments within each ellipse along the connecting direction.
}
The final distance ratio is computed as:
\deqn{(distance\_between\_centers + 0.01) / (sum\_of\_ellipse\_radii + 0.01)}
}
\examples{
\dontrun{
  dist_matrix <- EstimateDistance(Spr1, Spr2)
  heatmap(dist_matrix)
}

}
\seealso{
\code{\link{EstimateSpread}}, \code{\link{EllipseLine_intersection}}
}
